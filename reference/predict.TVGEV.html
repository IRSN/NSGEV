<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Predict Method for TVGEV Objects — predict.TVGEV • NSGEV</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Predict Method for TVGEV Objects — predict.TVGEV"><meta property="og:description" content="Predict method for TVGEV objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="../articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="../articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="../articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
    <li>
      <a href="../articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Predict Method for <code>TVGEV</code> Objects</h1>
    <small class="dont-index">Source: <a href="https://github.com/IRSN/NSGEV/blob/0.2.0/R/predictTVGEV.R" class="external-link"><code>R/predictTVGEV.R</code></a></small>
    <div class="hidden name"><code>predict.TVGEV.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Predict method for <code>TVGEV</code> objects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'TVGEV'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  newdate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  confintMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"none"</span>, <span class="st">"boot"</span>, <span class="st">"proflik"</span><span class="op">)</span>,</span>
<span>  out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data.frame"</span>, <span class="st">"array"</span><span class="op">)</span>,</span>
<span>  biasCorrect <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trace <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object with S3 class <code>"TVGEV"</code></p></dd>


<dt id="arg-newdate">newdate<a class="anchor" aria-label="anchor" href="#arg-newdate"></a></dt>
<dd><p>A vector with class <code>"Date"</code> or that can be
coerced to this class.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p>Numeric vector of periods expressed as multiple of
the block duration. Usually the block duration is one year and a
value <code>100</code> will correspond to a 100-year return level, i.e.
to the GEV quantile with probability 0.99. The default value
allows the construction of an acceptable RL plot, but if a
smoother RL curve and/or Confidence Band is needed, more values
would be used.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Numeric vector of confidence level(s).</p></dd>


<dt id="arg-confintmethod">confintMethod<a class="anchor" aria-label="anchor" href="#arg-confintmethod"></a></dt>
<dd><p>The method used to compute the confidence
intervals. See <b>Details</b>.</p></dd>


<dt id="arg-out">out<a class="anchor" aria-label="anchor" href="#arg-out"></a></dt>
<dd><p>Type of output.</p></dd>


<dt id="arg-biascorrect">biasCorrect<a class="anchor" aria-label="anchor" href="#arg-biascorrect"></a></dt>
<dd><p><code>Logical</code> used only when
<code>confintMethod</code> is <code>"boot"</code>. When <code>TRUE</code>, the RL
named <code>"Quantile"</code> is computed as the average of the RLs
obtained with the bootstraped parameters, and it will differ from
the RL computed with the estimated parameters in <code>object</code>.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>Integer level of verbosity.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments to be passed to <code>bs</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame or an array with the RL and confidence limits
for each combination of <em>date</em>, <em>period</em> and
<em>confidence level</em>. So when <code>confintMethod</code> is not
<code>"none"</code> the three values <code>Quant</code>, <code>L</code> and <code>U</code>
are given for each combination (the first not depending on the
confidence level). The data frame is in 'long' format, with
 different rows for multiple levels.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>Compute the Return Levels (RLs) for different periods and
different values of the time block, as well as Confidence
Intervals (CIs) for these. The results are not predictions in the
usual acceptance.  The CIs can be obtained by the usual
<em>delta method</em>, provided that the approximate covariance for
the estimated parameters is found in <code>object</code>. They also can
be obtained by <em>bootstrap</em>, using by default the bootstrap
distribution embeded in <code>object</code> if any or by computing it
else. The bootstrap can be parametric or non-parametric, see
<code><a href="bs.TVGEV.html">bs.TVGEV</a></code>. Finally, the <em>profile-likelihood</em>
method can be used: the confidence limits for a RL are obtained by
maximising and minimising this RL under the constraint that the
log-likelihood is greater than a suitable value. This method
avoids the usual re-parameterisation of the model which can be
tedious for the general form of model allowed in <code>TVGEV</code>.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>Despite of its positive sounding name, the "bias correction"
can have a negative impact with some Extreme Value models as used
here, especially for non-parametric bootstrap. In future versions,
the dots <code>...</code> might be used to control the profile-likelihood
as well as the bootstrap.</p>
    </div>
    <div id="caution">
    <h2>Caution</h2>
    <p>When <code>confintMethod</code> is set to
<code>"loglik"</code> the required computing time is huge because
several constrained optimisations are required. Since the marginal
distribution hence the RL vary only slowly in practice, an
unnecessary computing burden will result when many values of
<code>newdate</code> are used.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The bootstrap method <code><a href="bs.TVGEV.html">bs.TVGEV</a></code> for
<code>TVGEV</code> objects, the formal arguments of which can be used
here when <code>confintMethod</code> is chosen as <code>"boot"</code>.</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Yves Deville</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">TVGEV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## transform a numeric year into a date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; df &lt;- within(TXMax_Dijon, Date &lt;- as.Date(sprintf("%4d-01-01", Year)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; df0 &lt;- subset(df, !is.na(TXMax))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## fit a TVGEV model. Only the location parameter is TV.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t1 &lt;- system.time(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+     res1 &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   design = breaksX(date = Date, breaks = "1970-01-01", degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   loc = ~ t1 + t1_1970))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## The same using "nloptr" optimisation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t2 &lt;- system.time(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+     res2 &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   design = breaksX(date = Date, breaks = "1970-01-01", degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   loc = ~ t1 + t1_1970,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   estim = "nloptr",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   parTrack = TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## use extRemes::fevd the required variables need to be added to the data frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## passed as 'data' argument</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t0 &lt;- system.time({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+    df0.evd &lt;- cbind(df0, breaksX(date = df0$Date, breaks = "1970-01-01",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                     degree = 1));</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+    res0 &lt;- fevd(x = df0.evd$TXMax, data = df0.evd, loc = ~ t1 + t1_1970)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+  })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## compare estimate and negative log-liks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; cbind("fevd" = res0$results$par,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_optim" = res1$estimate,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_nloptr" = res2$estimate)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              fevd TVGEV_optim TVGEV_nloptr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu0   32.06678895 32.06638460  32.06679282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu1   -0.02391857 -0.02392656  -0.02391856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu2    0.07727041  0.07728411   0.07727061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  1.75585289  1.75541862   1.75585353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape -0.18130928 -0.18112018  -0.18131041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; cbind("fevd" = res0$results$value,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "VGEV_optim" = res1$negLogLik,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_nloptr" = res2$negLogLik)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          fevd VGEV_optim TVGEV_nloptr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 177.2014   177.2014     177.2014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## ====================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## use a loop on plausible break years. The fitted models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## are stored within a list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## ====================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## Not run: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     yearBreaks &lt;- c(1940, 1950, 1955, 1960:2000, 2005, 2010)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     res &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     for (ib in seq_along(yearBreaks)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         d &lt;- sprintf("%4d-01-01", yearBreaks[[ib]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         floc &lt;- as.formula(sprintf("~ t1 + t1_%4d", yearBreaks[[ib]]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         res[[d]] &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         design = breaksX(date = Date, breaks = d, degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         loc = floc)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## [continuing...] ]find the model with maximum likelihood, and plot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## something like a profile likelihood for the break date considered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## as a new parameter. However, the model is not differentiable w.r.t.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## the break! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ll &lt;- sapply(res, logLik)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     plot(yearBreaks, ll, type = "o", pch = 21, col = "orangered",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D          lwd = 2, bg = "gold", xlab = "break", ylab = "log-lik")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     grid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     iMax &lt;- which.max(ll)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     abline(v = yearBreaks[iMax])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     abline(h = ll[iMax] - c(0, qchisq(0.95, df = 1) /2),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D            col = "SpringGreen3", lwd = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## End(Not run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, confintMethod <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Since 'object' is really time-varying, the Return Levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> depend on the date. A default choice of dates is made here.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use the 'newdate' formal to change this.</span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, confintMethod <span class="op">=</span> <span class="st">"delta"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Since 'object' is really time-varying, the Return Levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> depend on the date. A default choice of dates is made here.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use the 'newdate' formal to change this.</span>
<span class="r-in"><span><span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, confintMethod <span class="op">=</span> <span class="st">"boot"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Since 'object' is really time-varying, the Return Levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> depend on the date. A default choice of dates is made here.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use the 'newdate' formal to change this.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 'object' does not embed a bootstrap distribution. Using `bs` to compute this.</span>
<span class="r-in"><span><span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, newdate <span class="op">=</span> <span class="st">"2020-01-01"</span>, confintMethod <span class="op">=</span> <span class="st">"proflik"</span><span class="op">)</span> </span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> o Finding CI for Return Levels</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Lower bounds </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:  0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   o Date: 2020-01-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:   1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   39.81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000414</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   39.58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000017</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0009</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   39.18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0081</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   39.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   38.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0034</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:     50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   38.34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   37.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   36.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0031</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:   35.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000111</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Upper bounds </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> **************</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence Level:  0.95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   o Date: 2020-01-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:   1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -45.70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0378</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    500</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -44.74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0068</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -43.46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    150</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -43.05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000114</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0078</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:    100</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -42.47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000137</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0037</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:     50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -41.49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000181</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:     20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -40.21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0084</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:     10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -39.24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0048</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - Period:      5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Optimisation status: 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Iterations: 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Objective:  -38.22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Constraint check -0.0000192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Gradient directions:  0.0019</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

