<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Bootstrap for a TVGEV Model — bs.TVGEV • NSGEV</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Bootstrap for a TVGEV Model — bs.TVGEV"><meta property="og:description" content="Bootstrap for a TVGEV model."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="../articles/NSGEVTS.html">Timeseries Covariates with NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="../articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="../articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
    <li>
      <a href="../articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap for a <code>TVGEV</code> Model</h1>
    <small class="dont-index">Source: <a href="https://github.com/IRSN/NSGEV/blob/main/R/TVGEV.R" class="external-link"><code>R/TVGEV.R</code></a></small>
    <div class="hidden name"><code>bs.TVGEV.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Bootstrap for a <code>TVGEV</code> model.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'TVGEV'</span></span>
<span><span class="fu"><a href="bs.html">bs</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"param"</span>, <span class="st">"NP"</span><span class="op">)</span>,</span>
<span>  estim <span class="op">=</span> <span class="st">"optim"</span>,</span>
<span>  parallel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>TVGEV</code> object.</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Target number of bootstrap samples.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character. The values <code>"param"</code> and <code>"NP"</code>
can be used to chose between parametric and nonparametric bootstrap,
see <b>Details</b>.</p></dd>


<dt id="arg-estim">estim<a class="anchor" aria-label="anchor" href="#arg-estim"></a></dt>
<dd><p>Argument passed to <code>MLE</code>.</p></dd>


<dt id="arg-parallel">parallel<a class="anchor" aria-label="anchor" href="#arg-parallel"></a></dt>
<dd><p>Logical. If <code>TRUE</code> the loop over the bootstrap
sample is performed using <code>foreach</code> with <code>%do par%</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Further arguments passed to <code>MLE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A matrix containing the bootstraped parameter vectors,
with one row for each bootstrap sample.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The parametric bootstrap (<code>type = "param"</code>) is as follows: for
each bootstrap sample, a response vector
\(\mathbf{y}^\star\) is drawn from the estimated GEV
distribution as described in <code>object</code>; a MLE is performed to
find the bootstraped parameter vector
\(\boldsymbol{\psi}^\star\). For the nonparametric
bootstrap (<code>type = "NP"</code>), the generalised residuals of the
object as returned by <code><a href="residuals.TVGEV.html">residuals.TVGEV</a></code> are resampled
and are back-transformed to simulated observations; a MLE is then
performed to find the bootstraped parameter vector
\(\boldsymbol{\psi}^\star\) as in the parametric case.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>The simulated response does not cover the observations where
the original response was <code>NA</code>.</p>
    </div>
    <div id="caution">
    <h2>Caution</h2>
    <p>For some bootstrap samples, the MLE may fail, in
which case the coefficients will be ignored. So the true number
of sampled coefficient vecors  will generally be smaller than the
target number as given in <code>R</code>.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">TVGEV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## transform a numeric year into a date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; df &lt;- within(TXMax_Dijon, Date &lt;- as.Date(sprintf("%4d-01-01", Year)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; df0 &lt;- subset(df, !is.na(TXMax))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## fit a TVGEV model. Only the location parameter is TV.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t1 &lt;- system.time(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+     res1 &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   design = breaksX(date = Date, breaks = "1970-01-01", degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   loc = ~ t1 + t1_1970))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## The same using "nloptr" optimisation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t2 &lt;- system.time(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+     res2 &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   design = breaksX(date = Date, breaks = "1970-01-01", degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   loc = ~ t1 + t1_1970,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   estim = "nloptr",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   parTrack = TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## use extRemes::fevd the required variables need to be added to the data frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## passed as 'data' argument</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t0 &lt;- system.time({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+    df0.evd &lt;- cbind(df0, breaksX(date = df0$Date, breaks = "1970-01-01",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                     degree = 1));</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+    res0 &lt;- fevd(x = df0.evd$TXMax, data = df0.evd, loc = ~ t1 + t1_1970)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+  })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## compare estimate and negative log-liks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; cbind("fevd" = res0$results$par,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_optim" = res1$estimate,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_nloptr" = res2$estimate)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              fevd TVGEV_optim TVGEV_nloptr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu0   32.06678895 32.06638460  32.06679282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu1   -0.02391857 -0.02392656  -0.02391856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu2    0.07727041  0.07728411   0.07727061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  1.75585289  1.75541862   1.75585353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape -0.18130928 -0.18112018  -0.18131041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; cbind("fevd" = res0$results$value,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "VGEV_optim" = res1$negLogLik,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_nloptr" = res2$negLogLik)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          fevd VGEV_optim TVGEV_nloptr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 177.2014   177.2014     177.2014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## ====================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## use a loop on plausible break years. The fitted models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## are stored within a list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## ====================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## Not run: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     yearBreaks &lt;- c(1940, 1950, 1955, 1960:2000, 2005, 2010)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     res &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     for (ib in seq_along(yearBreaks)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         d &lt;- sprintf("%4d-01-01", yearBreaks[[ib]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         floc &lt;- as.formula(sprintf("~ t1 + t1_%4d", yearBreaks[[ib]]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         res[[d]] &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         design = breaksX(date = Date, breaks = d, degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         loc = floc)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## [continuing...] ]find the model with maximum likelihood, and plot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## something like a profile likelihood for the break date considered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## as a new parameter. However, the model is not differentiable w.r.t.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## the break! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ll &lt;- sapply(res, logLik)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     plot(yearBreaks, ll, type = "o", pch = 21, col = "orangered",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D          lwd = 2, bg = "gold", xlab = "break", ylab = "log-lik")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     grid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     iMax &lt;- which.max(ll)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     abline(v = yearBreaks[iMax])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     abline(h = ll[iMax] - c(0, qchisq(0.95, df = 1) /2),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D            col = "SpringGreen3", lwd = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## End(Not run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-in"><span><span class="va">bsb</span> <span class="op">&lt;-</span> <span class="fu"><a href="bs.html">bs</a></span><span class="op">(</span><span class="va">res2</span>, R <span class="op">=</span> <span class="fl">50</span>, estim <span class="op">=</span> <span class="st">"nloptr"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>convergence not reached in optimisation</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RevolutionAnalytics/doparallel" class="external-link">doParallel</a></span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="va">cl</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">makeCluster</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/pkg/doParallel/man/registerDoParallel.html" class="external-link">registerDoParallel</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>   <span class="co">## findings: with 'nloptr', less than 1% of the optimisations</span></span></span>
<span class="r-in"><span>   <span class="co">## diverges, while more than 10% diverged with 'optim'.</span></span></span>
<span class="r-in"><span>   <span class="va">te</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">bspb</span> <span class="op">&lt;-</span> <span class="fu"><a href="bs.html">bs</a></span><span class="op">(</span><span class="va">res2</span>, R <span class="op">=</span> <span class="fl">5000</span>, estim <span class="op">=</span> <span class="st">"nloptr"</span>,</span></span>
<span class="r-in"><span>                                parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="fu"><a href="https://rdrr.io/r/parallel/makeCluster.html" class="external-link">stopCluster</a></span><span class="op">(</span><span class="va">cl</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## add the 'bs' results to the model object as 'boot' element,</span></span></span>
<span class="r-in"><span><span class="co">## in order to facilitate the prediction. The number of</span></span></span>
<span class="r-in"><span><span class="co">## bootstrap replicates in the prediction will correspond</span></span></span>
<span class="r-in"><span><span class="co">## to the number of replications stored in the model object,</span></span></span>
<span class="r-in"><span><span class="co">## an no longer to the default</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res2</span><span class="op">$</span><span class="va">boot</span> <span class="op">&lt;-</span> <span class="va">bsb</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">res2</span>, confintMethod <span class="op">=</span> <span class="st">"boot"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Since 'object' is really time-varying, the Return Levels</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> depend on the date. A default choice of dates is made here.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Use the 'newdate' formal to change this.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'object' embeds a bootstrap distribution. Formal arguments</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>  intented to be passed to `bs` (if any) will be ignored</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Period Level Id       Date        L    Quant        U</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1       5   95%  1 1920-01-01 34.37176 35.56868 36.78309</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2       5   95%  2 1970-01-01 33.71856 34.37272 34.94116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3       5   95%  3 2020-01-01 35.83685 37.04025 38.05875</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4      10   95%  1 1920-01-01 35.32215 36.50728 37.74905</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5      10   95%  2 1970-01-01 34.52955 35.31131 35.89317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6      10   95%  3 2020-01-01 36.75191 37.97884 39.01963</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7      20   95%  1 1920-01-01 35.93496 37.29520 38.63042</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8      20   95%  2 1970-01-01 35.16045 36.09924 36.84051</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9      20   95%  3 2020-01-01 37.53289 38.76677 39.80647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10     50   95%  1 1920-01-01 36.40651 38.17369 39.50825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11     50   95%  2 1970-01-01 35.86145 36.97773 37.83633</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12     50   95%  3 2020-01-01 38.16569 39.64526 40.70356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13    100   95%  1 1920-01-01 36.67347 38.74128 40.17186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14    100   95%  2 1970-01-01 36.09604 37.54532 38.63932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15    100   95%  3 2020-01-01 38.45821 40.21285 41.39201</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16    150   95%  1 1920-01-01 36.80239 39.04056 40.53249</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17    150   95%  2 1970-01-01 36.20348 37.84460 39.08296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 18    150   95%  3 2020-01-01 38.60104 40.51213 41.80834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 19    200   95%  1 1920-01-01 36.86953 39.23966 40.77621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 20    200   95%  2 1970-01-01 36.26991 38.04370 39.38652</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 21    200   95%  3 2020-01-01 38.69160 40.71123 42.09230</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 22    500   95%  1 1920-01-01 37.02903 39.80798 41.52190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 23    500   95%  2 1970-01-01 36.44974 38.61202 40.19845</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 24    500   95%  3 2020-01-01 38.93005 41.27955 42.97116</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 25   1000   95%  1 1920-01-01 37.11605 40.17894 42.05897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 26   1000   95%  2 1970-01-01 36.58897 38.98298 40.93577</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 27   1000   95%  3 2020-01-01 39.06924 41.65051 43.60238</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

