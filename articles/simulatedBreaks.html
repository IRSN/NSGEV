<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TVGEV: Check Simulated Trend ‚Ä¢ NSGEV</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TVGEV: Check Simulated Trend">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="../articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="../articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="../articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
    <li>
      <a href="../articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TVGEV: Check Simulated Trend</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/IRSN/NSGEV/blob/main/vignettes/simulatedBreaks.Rmd" class="external-link"><code>vignettes/simulatedBreaks.Rmd</code></a></small>
      <div class="hidden name"><code>simulatedBreaks.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="the-broken-line-trend">The broken line trend<a class="anchor" aria-label="anchor" href="#the-broken-line-trend"></a>
</h2>
<p>In this report we simulate a trend for the location parameter. We
chose the model
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>b</mi></msub><mo>‚àº</mo><mtext mathvariant="normal">GEV</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>b</mi></msub><mo>,</mo><mspace width="0.167em"></mspace><mi>œÉ</mi><mo>,</mo><mspace width="0.167em"></mspace><mi>Œæ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_b \sim \text{GEV}(\mu_b, \, \sigma, \,\xi)</annotation></semantics></math>
with constant scale and shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>,
while the location is given by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>b</mi></msub><mo>=</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>+</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>2</mn></mrow></msub><msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo>‚àí</mo><msub><mi>b</mi><mn>0</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo></msub></mrow><annotation encoding="application/x-tex">
    \mu_b = \psi_{\mu, 0} + \psi_{\mu, 1} + \psi_{\mu, 2} (b - b_0)_+    
</annotation></semantics></math></p>
<p>where the annual block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mn>0</mn></msub><annotation encoding="application/x-tex">b_0</annotation></semantics></math>
is chosen to be
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1980</mn><annotation encoding="application/x-tex">1980</annotation></semantics></math>,
and the data will from 1921 to 2020. Using the <code>breaksX</code>
design function we get a matrix <code>X</code> with a linear trend
<code>t1</code> and a broken line <code>t1_1980</code> with slope:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>0</mn><annotation encoding="application/x-tex">0</annotation></semantics></math>
before 1980 and slope
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
from
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1980</mn><annotation encoding="application/x-tex">1980</annotation></semantics></math>
on.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IRSN/NSGEV/" class="external-link">NSGEV</a></span><span class="op">)</span></span>
<span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%4d-01-01"</span>, <span class="fl">1921</span><span class="op">:</span><span class="fl">2020</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/breaksX.html">breaksX</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">date</span>, breaks <span class="op">=</span> <span class="st">"1980-01-01"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span><span class="va">date</span>, <span class="st">"%Y"</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">X</span><span class="op">[</span> , <span class="fl">1</span><span class="op">]</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"n"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matlines</a></span><span class="op">(</span><span class="va">date</span>, <span class="va">X</span>, type <span class="op">=</span> <span class="st">"l"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> </span></code></pre></div>
<p><img src="Rgraphics%2Fsim0-1.png" width="576"></p>
</div>
<div class="section level2">
<h2 id="simulation-of-the-data-and-gev-estimation">Simulation of the data and GEV estimation<a class="anchor" aria-label="anchor" href="#simulation-of-the-data-and-gev-estimation"></a>
</h2>
<p>We simulate a sample of size <code>ns</code> for the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùõô</mi><annotation encoding="application/x-tex">\boldsymbol{\psi}</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">p=4</annotation></semantics></math>
coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">\psi_{\mu, 0}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\psi_{\mu, 1}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>.
The results are stored in a matrix <code>psi</code> with <code>ns</code>
rows.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span>    </span>
<span><span class="va">GEVnms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"loc"</span>, <span class="st">"scale"</span>, <span class="st">"shape"</span><span class="op">)</span>  </span>
<span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fl">400</span></span>
<span><span class="va">pLoc</span> <span class="op">&lt;-</span> <span class="fl">3</span></span>
<span><span class="va">psiLoc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">ns</span> <span class="op">*</span> <span class="va">pLoc</span>, sd <span class="op">=</span> <span class="fl">0.15</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">ns</span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="va">ns</span>, shape <span class="op">=</span> <span class="fl">4</span>, rate <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">xi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">ns</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="va">psi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">psiLoc</span>, <span class="va">sigma</span>, <span class="va">xi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"mu"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span>, <span class="st">"sigma_0"</span>, <span class="st">"xi_0"</span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">psi</span>, n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">mu_0</th>
<th align="right">mu_t1</th>
<th align="right">mu_t1_1980</th>
<th align="right">sigma_0</th>
<th align="right">xi_0</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">-0.181</td>
<td align="right">-0.184</td>
<td align="right">-0.154</td>
<td align="right">0.684</td>
<td align="right">-0.047</td>
</tr>
<tr class="even">
<td align="right">0.042</td>
<td align="right">0.005</td>
<td align="right">-0.208</td>
<td align="right">1.247</td>
<td align="right">0.058</td>
</tr>
<tr class="odd">
<td align="right">0.163</td>
<td align="right">-0.063</td>
<td align="right">-0.007</td>
<td align="right">0.608</td>
<td align="right">0.042</td>
</tr>
<tr class="even">
<td align="right">-0.352</td>
<td align="right">-0.135</td>
<td align="right">0.272</td>
<td align="right">3.302</td>
<td align="right">0.068</td>
</tr>
</tbody>
</table>
<p>Then we create a three-dimensional array <code>theta</code> with
dimension <code>c(ns, n , 3)</code>. A slice <code>theta[is, , ]</code>
will contain the GEV parameters for the simulation number
<code>is</code> i.e., a matrix with dimension <code>c(n , 3)</code> of
the GEV parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùõâ</mi><mi>b</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\theta}_b</annotation></semantics></math>
for the blocks
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b=1</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mi>n</mi></mrow><annotation encoding="application/x-tex">b =n</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns</span>, <span class="va">n</span>, <span class="fl">3</span><span class="op">)</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, <span class="va">GEVnms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">Y</span> <span class="op">&lt;-</span> <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns</span>, <span class="va">n</span><span class="op">)</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fitTVGEV</span> <span class="op">&lt;-</span> <span class="va">fitextRemes</span> <span class="op">&lt;-</span> <span class="va">fitismev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">co</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns</span>, <span class="fl">3</span>, <span class="va">p</span><span class="op">)</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV"</span>, <span class="st">"extR"</span>, <span class="st">"ismev"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">psi</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">ML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>            dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV"</span>, <span class="st">"extR"</span>, <span class="st">"ismev"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">CVG</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">NA</span>, dim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ns</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>             dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV"</span>, <span class="st">"extR"</span>, <span class="st">"ismev"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">estim</span> <span class="op">&lt;-</span> <span class="st">"optim"</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">is</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">ns</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">X</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">psiLoc</span><span class="op">[</span><span class="va">is</span>, <span class="op">]</span></span>
<span>    <span class="va">theta</span><span class="op">[</span><span class="va">is</span>, , <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">mu</span>, <span class="va">sigma</span><span class="op">[</span><span class="va">is</span><span class="op">]</span>, <span class="va">xi</span><span class="op">[</span><span class="va">is</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">Y</span><span class="op">[</span><span class="va">is</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nieve/man/GEV.html" class="external-link">rGEV</a></span><span class="op">(</span><span class="fl">1</span>,</span>
<span>                    loc <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="va">is</span>, , <span class="fl">1</span><span class="op">]</span>,</span>
<span>                    scale <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="va">is</span>, , <span class="fl">2</span><span class="op">]</span>,</span>
<span>                    shape <span class="op">=</span> <span class="va">theta</span><span class="op">[</span><span class="va">is</span>, , <span class="fl">3</span><span class="op">]</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">date</span>, Y <span class="op">=</span> <span class="va">Y</span><span class="op">[</span><span class="va">is</span>, <span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">fitTVGEV</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">NSGEV</span><span class="fu">::</span><span class="fu"><a href="../reference/TVGEV.html">TVGEV</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, response <span class="op">=</span> <span class="st">"Y"</span>, date <span class="op">=</span> <span class="st">"date"</span>,</span>
<span>                                       design <span class="op">=</span> <span class="fu"><a href="../reference/breaksX.html">breaksX</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">date</span>,</span>
<span>                                           breaks <span class="op">=</span> <span class="st">"1980-01-01"</span>,</span>
<span>                                           degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                                       estim <span class="op">=</span> <span class="va">estim</span>,</span>
<span>                                       loc <span class="op">=</span> <span class="op">~</span> <span class="va">t1</span> <span class="op">+</span> <span class="va">t1_1980</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">fitTVGEV</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">estim</span> <span class="op">==</span> <span class="st">"optim"</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"NSGEV"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">fitTVGEV</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"NSGEV"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">fitTVGEV</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">fit</span><span class="op">$</span><span class="va">status</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"NSGEV"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">co</span><span class="op">[</span><span class="va">is</span>, <span class="st">"NSGEV"</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fitTVGEV</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>            <span class="va">ML</span><span class="op">[</span><span class="va">is</span>, <span class="st">"NSGEV"</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">fitTVGEV</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"NSGEV"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>     </span>
<span>    <span class="va">df.extRemes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="../reference/breaksX.html">breaksX</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">df</span><span class="op">$</span><span class="va">date</span>, breaks <span class="op">=</span> <span class="st">"1980-01-01"</span>,</span>
<span>                                     degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>;</span>
<span>    <span class="va">fitextRemes</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">extRemes</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">fevd</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df.extRemes</span><span class="op">$</span><span class="va">Y</span>, data <span class="op">=</span> <span class="va">df.extRemes</span>,</span>
<span>                                            loc <span class="op">=</span> <span class="op">~</span> <span class="va">t1</span> <span class="op">+</span> <span class="va">t1_1980</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">fitextRemes</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"extR"</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="op">(</span><span class="va">fitextRemes</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"extR"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">co</span><span class="op">[</span><span class="va">is</span>, <span class="st">"extR"</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fitextRemes</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">par</span></span>
<span>            <span class="va">ML</span><span class="op">[</span><span class="va">is</span>, <span class="st">"extR"</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="op">-</span><span class="va">fitextRemes</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">results</span><span class="op">$</span><span class="va">value</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"extR"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>    <span class="va">fitismev</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">ismev</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">gev.fit</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">df.extRemes</span><span class="op">$</span><span class="va">Y</span>,</span>
<span>                                         y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">as.matrix</a></span><span class="op">(</span><span class="va">df.extRemes</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"t1"</span>, <span class="st">"t1_1980"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                                         mul <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, show <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">fitismev</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"ismev"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">fitismev</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">conv</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"ismev"</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">co</span><span class="op">[</span><span class="va">is</span>, <span class="st">"ismev"</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">fitismev</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">mle</span></span>
<span>            <span class="va">ML</span><span class="op">[</span><span class="va">is</span>, <span class="st">"ismev"</span><span class="op">]</span> <span class="op">&lt;-</span>  <span class="op">-</span><span class="va">fitismev</span><span class="op">[[</span><span class="va">is</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">nllh</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="va">CVG</span><span class="op">[</span><span class="va">is</span>, <span class="st">"ismev"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span>
<span>    </span>
<span><span class="op">}</span></span></code></pre></div>
<p>Error in
solve.default(x<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mi>e</mi><mi>s</mi><mi>s</mi><mi>i</mi><mi>a</mi><mi>n</mi><mo stretchy="false" form="postfix">)</mo><mo>:</mo><mi>L</mi><mi>a</mi><mi>p</mi><mi>a</mi><mi>c</mi><mi>k</mi><mi>r</mi><mi>o</mi><mi>u</mi><mi>t</mi><mi>i</mi><mi>n</mi><mi>e</mi><mi>d</mi><mi>g</mi><mi>e</mi><mi>s</mi><mi>v</mi><mo>:</mo><mi>s</mi><mi>y</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>m</mi><mi>i</mi><mi>s</mi><mi>e</mi><mi>x</mi><mi>a</mi><mi>c</mi><mi>t</mi><mi>l</mi><mi>y</mi><mi>s</mi><mi>i</mi><mi>n</mi><mi>g</mi><mi>u</mi><mi>l</mi><mi>a</mi><mi>r</mi><mo>:</mo><mi>U</mi><mrow><mo stretchy="true" form="prefix">[</mo><mn>2</mn><mo>,</mo><mn>2</mn><mo stretchy="true" form="postfix">]</mo></mrow><mo>=</mo><mn>0</mn><mi>E</mi><mi>r</mi><mi>r</mi><mi>o</mi><mi>r</mi><mi>i</mi><mi>n</mi><mi>s</mi><mi>o</mi><mi>l</mi><mi>v</mi><mi>e</mi><mi>.</mi><mi>d</mi><mi>e</mi><mi>f</mi><mi>a</mi><mi>u</mi><mi>l</mi><mi>t</mi><mo stretchy="false" form="prefix">(</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">hessian) :
  Lapack routine dgesv: system is exactly singular: U[2,2] = 0
Error in solve.default(x</annotation></semantics></math>hessian) :
Lapack routine dgesv: system is exactly singular: U[2,2] = 0</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">Y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Rgraphics%2FsimPlot-1.png" alt="Ten simulated paths" width="576"><p class="caption">
Ten simulated paths
</p>
</div>
</div>
<div class="section level2">
<h2 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h2>
<p>We can assess the convergence for the three estimation methods.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">CVG</span>, <span class="fl">2</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">NSGEV</th>
<th align="right">extR</th>
<th align="right">ismev</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">400</td>
<td align="right">399</td>
<td align="right">394</td>
</tr></tbody>
</table>
<p>We can inspect the content of the array <code>co</code> containing
the estimated coefficients
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõô</mi><mo accent="true">ÃÇ</mo></mover><annotation encoding="application/x-tex">\widehat{\boldsymbol{\psi}}</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/aperm.html" class="external-link">aperm</a></span><span class="op">(</span><span class="va">co</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, , <span class="op">]</span>, perm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<colgroup>
<col width="13%">
<col width="10%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="10%">
<col width="10%">
<col width="8%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">NSGEV.1</th>
<th align="right">extR.1</th>
<th align="right">ismev.1</th>
<th align="right">NSGEV.2</th>
<th align="right">extR.2</th>
<th align="right">ismev.2</th>
<th align="right">NSGEV.3</th>
<th align="right">extR.3</th>
<th align="right">ismev.3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">mu_0</td>
<td align="right">-0.236</td>
<td align="right">-3.070</td>
<td align="right">-3.396</td>
<td align="right">0.174</td>
<td align="right">0.174</td>
<td align="right">0.174</td>
<td align="right">0.095</td>
<td align="right">0.095</td>
<td align="right">0.095</td>
</tr>
<tr class="even">
<td align="left">mu_t1</td>
<td align="right">-0.184</td>
<td align="right">-0.153</td>
<td align="right">-0.220</td>
<td align="right">0.005</td>
<td align="right">0.005</td>
<td align="right">0.005</td>
<td align="right">-0.066</td>
<td align="right">-0.066</td>
<td align="right">-0.066</td>
</tr>
<tr class="odd">
<td align="left">mu_t1_1980</td>
<td align="right">-0.143</td>
<td align="right">-0.228</td>
<td align="right">-0.056</td>
<td align="right">-0.206</td>
<td align="right">-0.206</td>
<td align="right">-0.206</td>
<td align="right">0.006</td>
<td align="right">0.006</td>
<td align="right">0.006</td>
</tr>
<tr class="even">
<td align="left">sigma_0</td>
<td align="right">0.728</td>
<td align="right">6.612</td>
<td align="right">6.090</td>
<td align="right">1.317</td>
<td align="right">1.317</td>
<td align="right">1.317</td>
<td align="right">0.560</td>
<td align="right">0.560</td>
<td align="right">0.559</td>
</tr>
<tr class="odd">
<td align="left">xi_0</td>
<td align="right">0.010</td>
<td align="right">-1.030</td>
<td align="right">-1.116</td>
<td align="right">0.136</td>
<td align="right">0.136</td>
<td align="right">0.136</td>
<td align="right">0.089</td>
<td align="right">0.089</td>
<td align="right">0.089</td>
</tr>
</tbody>
</table>
<p>There are cases where the estimation fails, and also cases where
estimations seem successful but lead to very different estimated
coefficients. In such case, we can compare the maximised log-likelihood
stored in the array <code>ML</code>. For example this happens here for
the first simulation; we selected the random seed so that the results
for first estimation differ, but the conclusion are the same when
another seed is used. The log-likelihoods for the four first simulated
samples are as follows.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">MLcomp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">ML</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">MLcomp</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"sim"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">MLcomp</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">sim 1</th>
<th align="right">sim 2</th>
<th align="right">sim 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">NSGEV</td>
<td align="right">-127.229</td>
<td align="right">-193.43</td>
<td align="right">-104.646</td>
</tr>
<tr class="even">
<td align="left">extR</td>
<td align="right">-224.028</td>
<td align="right">-193.43</td>
<td align="right">-104.646</td>
</tr>
<tr class="odd">
<td align="left">ismev</td>
<td align="right">-217.656</td>
<td align="right">-193.43</td>
<td align="right">-104.646</td>
</tr>
</tbody>
</table>
<p>so the estimation produced by <strong>NSGEV</strong> seems better for
simulation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>#</mi><mn>1</mn></mrow><annotation encoding="application/x-tex">\#1</annotation></semantics></math>,
since it leads to a greater log-likelihood. Note the estimated shape
parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Œæ</mi><mo accent="true">ÃÇ</mo></mover><mo>&lt;</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\widehat{\xi} &lt; - 1</annotation></semantics></math>
both with <strong>extRemes</strong> and <strong>ismev</strong> which can
be considered as an alert. Indeed, as far as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œæ</mi><mo>&lt;</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\xi &lt; -1</annotation></semantics></math>
is allowed we could find an infinite log-likelihood and an estimated
shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&lt; - 1</annotation></semantics></math>
can be considered as a non-convergence or as an error.</p>
<p>We notice that both <code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">extRemes::fevd</a></code> and
<code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> tend to find not infrequently very low
values for the estimated shape,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Œæ</mi><mo accent="true">ÃÇ</mo></mover><mo>&lt;</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\widehat{\xi} &lt; -1</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">xiRange</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">co</span><span class="op">[</span> , , <span class="st">"xi_0"</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">range</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">xiRange</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"shape min"</span>, <span class="st">"shape max"</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="va">xiRange</span>, digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">NSGEV</th>
<th align="right">extR</th>
<th align="right">ismev</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">shape min</td>
<td align="right">-0.518</td>
<td align="right">-1.301</td>
<td align="right">-1.558</td>
</tr>
<tr class="even">
<td align="left">shape max</td>
<td align="right">0.428</td>
<td align="right">0.428</td>
<td align="right">1.073</td>
</tr>
</tbody>
</table>
<p>In order to compare the maximised log-likelihoods for the two
packages, we will consider that these are nearly equal when their
absolute difference is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mn>0.05</mn></mrow><annotation encoding="application/x-tex">&lt;0.05</annotation></semantics></math>
and set any <code>NA</code> value to <code>-Inf</code></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ML</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">ML</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="cn">Inf</span>  </span>
<span><span class="va">compML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ML</span><span class="op">[</span> , <span class="st">"NSGEV"</span><span class="op">]</span> <span class="op">-</span> <span class="va">ML</span><span class="op">[</span> , <span class="st">"extR"</span><span class="op">]</span>,</span>
<span>                    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV &lt; extR"</span>,</span>
<span>                        <span class="st">"NSGEV ~ extR"</span>,</span>
<span>                        <span class="st">"NSGEV &gt; extR"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">compML</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">NSGEV &lt; extR</th>
<th align="right">NSGEV ~ extR</th>
<th align="right">NSGEV &gt; extR</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0</td>
<td align="right">381</td>
<td align="right">19</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ML</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV"</span>, <span class="st">"extR"</span><span class="op">)</span><span class="op">]</span>, asp <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"orangered"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Rgraphics%2Fsim7-1.png" alt="Comparison of the maximised log-likelihoods." width="576"><p class="caption">
Comparison of the maximised log-likelihoods.
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">compML</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">ML</span><span class="op">[</span> , <span class="st">"NSGEV"</span><span class="op">]</span> <span class="op">-</span> <span class="va">ML</span><span class="op">[</span> , <span class="st">"ismev"</span><span class="op">]</span>,</span>
<span>                    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="cn">Inf</span>, <span class="op">-</span><span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="cn">Inf</span><span class="op">)</span>,</span>
<span>                    labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV &lt; ismev"</span>,</span>
<span>                        <span class="st">"NSGEV ~ ismev"</span>,</span>
<span>                        <span class="st">"NSGEV &gt; ismev"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">kable</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">compML</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="right">NSGEV &lt; ismev</th>
<th align="right">NSGEV ~ ismev</th>
<th align="right">NSGEV &gt; ismev</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0</td>
<td align="right">360</td>
<td align="right">40</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ML</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NSGEV"</span>, <span class="st">"ismev"</span><span class="op">)</span><span class="op">]</span>, asp <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fl">16</span>, col <span class="op">=</span> <span class="st">"SeaGreen"</span>, cex <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">0</span>, b <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure">
<img src="Rgraphics%2Fsim7b-1.png" alt="Comparison of the maximised log-likelihoods." width="576"><p class="caption">
Comparison of the maximised log-likelihoods.
</p>
</div>
<p>We find that for this kind of model, the maximised log-likelihood
found by <code><a href="../reference/TVGEV.html">NSGEV::TVGEV</a></code> is comparable to that found by
<code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">extRemes::fevd</a></code> and is even greater for a quite large
proportion of cases. More problems of convergence were found when using
the function <code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> than when using the two other
functions.</p>
<p>As a possible explanation for the fact that <code><a href="../reference/TVGEV.html">NSGEV::TVGEV</a></code>
performs better than the two other functions is that is uses better
initial values, based on linear regression. However this way of getting
initial values is straightforward only for models with constant scale
and shape as is the case here.</p>
</div>
<div class="section level2">
<h2 id="findings">Findings<a class="anchor" aria-label="anchor" href="#findings"></a>
</h2>
<p>In this example, we find that <em>for the kind of model studied
here</em>.</p>
<ul>
<li><p>All of the three functions <code><a href="../reference/TVGEV.html">NSGEV::TVGEV</a></code>,
<code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">extRemes::fevd</a></code> and <code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> can
experiment problems of convergence. These problems are much more
frequent with <code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> than with the two other
functions, and also seem to be pretty less frequent with
<code><a href="../reference/TVGEV.html">NSGEV::TVGEV</a></code> than with
<code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">extRemes::fevd</a></code>.</p></li>
<li><p>A problem with the functions <code><a href="https://rdrr.io/pkg/extRemes/man/fevd.html" class="external-link">extRemes::fevd</a></code> and
<code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> is that they quite often find estimates with
a shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>&lt;</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">&lt; -1</annotation></semantics></math>
which can be considered as absurd. For the simulated data used here, the
risk of finding
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>Œæ</mi><mo accent="true">ÃÇ</mo></mover><mo>&lt;</mo><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\widehat{\xi} &lt; -1</annotation></semantics></math>
is higher when the linear trend is stronger, i.e.¬†when the slope takes a
larger absolute value. Since real data usually show a weaker dependence
on the covariates than the data used here, the problems of convergence
shown here have been overstated.</p></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
