<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TVGEV: Checks • NSGEV</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TVGEV: Checks">
<meta property="og:description" content="NSGEV">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="../articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="../articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="../articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
    <li>
      <a href="../articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TVGEV: Checks</h1>
                        <h4 data-toc-skip class="author">Yves Deville,
Lise Bardet</h4>
            
            <h4 data-toc-skip class="date">2023-12-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IRSN/NSGEV/blob/HEAD/vignettes/NSGEV_Val.Rmd" class="external-link"><code>vignettes/NSGEV_Val.Rmd</code></a></small>
      <div class="hidden name"><code>NSGEV_Val.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="the-nsgev-package">The NSGEV Package<a class="anchor" aria-label="anchor" href="#the-nsgev-package"></a>
</h2>
<div class="section level3">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<div class="section level4">
<h4 id="non-stationary-gev-models">Non-Stationary GEV models<a class="anchor" aria-label="anchor" href="#non-stationary-gev-models"></a>
</h4>
<p>The <strong>NSGEV</strong> package is dedicated to Non-Stationary
models with Generalized Extreme Value (GEV) observations which are often
called <em>Extreme Value Regression</em> models. These concern data with
observations attached to <em>blocks</em> <span class="math inline">\(b =
1\)</span>, <span class="math inline">\(2\)</span>, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(B\)</span>, typically years. A response variable
<span class="math inline">\(Y\)</span> has one observation <span class="math inline">\(Y_b\)</span> for each block, which is typically a
maximum reached within the block <span class="math inline">\(b\)</span>.
The response relates to a vector <span class="math inline">\(\mathbf{x}\)</span> of covariates with
observations <span class="math inline">\(\mathbf{x}_b\)</span>. The
<span class="math inline">\(B\)</span> r.vs <span class="math inline">\(Y_b\)</span> are assumed to be independent with
GEV margin</p>
<p><span class="math display">\[
   Y_b \sim \text{GEV}(\mu_b,\,\sigma_b,\, \xi_b),
\]</span></p>
<p>and the three GEV parameters can depend on the covariates in <span class="math inline">\(\mathbf{x}_b\)</span> through a link function. For
example with one covariate <span class="math inline">\(x_b\)</span> we
can use</p>
<p><span class="math display">\[
  \mu_b = \psi_{\mu,0} + \psi_{\mu, 1} x_b,         
\]</span></p>
<p>where <span class="math inline">\(\psi_{\mu,0}\)</span> and <span class="math inline">\(\psi_{\mu, 1}\)</span> are parameters to be
estimated. The pseudo-index <span class="math inline">\(\mu\)</span> of
<span class="math inline">\(\psi\)</span> is used to show which GEV
parameter <span class="math inline">\(\psi\)</span> relates to. We can
have similarly a formula and a link for the scale <span class="math inline">\(\sigma\)</span> and even for the shape <span class="math inline">\(\xi\)</span>, leading to parameters <span class="math inline">\(\psi_{\sigma,i}\)</span> and <span class="math inline">\(\psi_{\xi,i}\)</span>.</p>
<p>An alternative notation for the GEV distribution uses the vector
<span class="math inline">\(\boldsymbol{\theta}_b :=
[\mu_b,\,\sigma_b,\,\xi_b]\)</span> and writes <span class="math inline">\(Y_b \sim
\text{GEV}(\boldsymbol{\theta}_b)\)</span>. The GEV parameters <span class="math inline">\(\theta_{b,i}\)</span> which depend on the block
<span class="math inline">\(b\)</span> should not be confused with the
parameters <span class="math inline">\(\psi\)</span> of the model, which
do not depend on the block <span class="math inline">\(b\)</span>.</p>
</div>
<div class="section level4">
<h4 id="time-varying-gev-models">Time-Varying GEV models<a class="anchor" aria-label="anchor" href="#time-varying-gev-models"></a>
</h4>
<p>This report mainly focuses on <em>Time-Varying</em> models which are
the main concern in the package, and are used as objects of a S3 class
named <code>"TVGEV"</code>. In this setting, the blocks are assumed to
have the <em>same duration</em>; Moreover, attached with each block
<span class="math inline">\(b\)</span> we have a <em>date</em> <span class="math inline">\(t_b\)</span> which can conveniently chosen as the
beginning of the block. The GEV parameters are now linked to covariates
which are deterministic functions <span class="math inline">\(x(t_b)\)</span> of <span class="math inline">\(t_b\)</span>. For instance, a quadratic trend can
be used for the location parameter <span class="math inline">\(\mu\)</span></p>
<p><span class="math display">\[
  \mu_b = \psi_{\mu, 0} + \psi_{\mu,1} \, t_b + \psi_{\mu,2} \,t_b^2.
\]</span></p>
<p>An implicit assumption is that <em>the GEV parameters should vary
slowly</em>, with only very small variation from a block to the next
one. So the choice of a specific reference date <span class="math inline">\(t_b\)</span> within the block <span class="math inline">\(b\)</span> does not really matter. We can think of
the vector of GEV parameters as a time-varying <span class="math inline">\(\boldsymbol{\theta}(t)\)</span> with a slow
variation.</p>
<p>For <code>TVGEV</code> models, we assume that each GEV parameter is
linked to a linear combination of the trend functions having the form
<span class="math inline">\(\mathbf{x}(t_b)^\top
\boldsymbol{\psi}\)</span>. The standard R formulas for linear models
can be used to specify the dependence of each GEV parameter on the basis
covariates via an object with class <code>"formula"</code>.</p>
<p>Although Time-Varying models may appear as special cases of more
general Non-Stationary models, they deserve a special treatment because
it is often a concern then to make special ‘predictions’ in relation
with a period of time or an origin.</p>
<p><em>Remark</em>. Choosing the begining of a block as reference date
<span class="math inline">\(t_b\)</span> is convenient because the it is
easy to convert a year number and a reference date are easily converted
into each other.</p>
</div>
<div class="section level4">
<h4 id="designs">Designs<a class="anchor" aria-label="anchor" href="#designs"></a>
</h4>
<p>Within the package are “design functions” which provide bases of
functions. A basis consist in <span class="math inline">\(r\)</span>
linearly independent functions <span class="math inline">\(x_k(t)\)</span> of the date <span class="math inline">\(t\)</span> forming a covariate vector <span class="math inline">\(\mathbf{x}(t)\)</span> of length <span class="math inline">\(r\)</span> with elements</p>
<p><span class="math display">\[
    x_0(t), \, x_1(t), \, \dots, \,x_{r-1}(t).  
\]</span></p>
<p>By evaluating the basis functions at the reference dates <span class="math inline">\(t_b\)</span> for <span class="math inline">\(b=1\)</span>, <span class="math inline">\(2\)</span>, <span class="math inline">\(\dots\)</span>, <span class="math inline">\(B\)</span> we get a “design” matrix <span class="math inline">\(\mathbf{X}\)</span> with <span class="math inline">\(B\)</span> rows and <span class="math inline">\(r\)</span> columns as in a linear regression
framework. As suggested by the use of a zero index, a basis might embed
the constant function <span class="math inline">\(x_0(t) = 1\)</span>.
For a polynomial basis, we can take <span class="math inline">\(x_k(t)
:= t^k\)</span> for <span class="math inline">\(k=0\)</span> to <span class="math inline">\(r-1\)</span>. However it is often necessary to
scale the basis functions because they can otherwise take large values,
which can cause problems in likelihood maximisation. A simple and widely
adopted precaution consists in changing the origin, i.e. in using <span class="math inline">\(x_k(t) := (t - t^\star)^k\)</span> for some chosen
origin <span class="math inline">\(t^\star\)</span>. By taking the
origin <span class="math inline">\(t^\star\)</span> as roughly located
at the centre of the time period used in the fit will neatly facilitate
the estimation.</p>
<p>For now, the design functions include: <em>polynomial</em> basis,
<em>natural spline</em> basis, and (continuous) broken line basis. Using
the broken line basis, it is possible to specify a <em>kink
regression</em>, but only with a known date for the change of slope.</p>
<p>In <strong>NSGEV</strong>, the definition of the design function used
by a TVGEV model is attached to the R object representing a fitted
model. So for a given “new” block given its reference date <span class="math inline">\(t^{\text{new}}\)</span> we can straightforwardly
obtain the estimated <span class="math inline">\(\widehat{\boldsymbol{\theta}}(t^{\text{new}})\)</span>
from the covariate vector <span class="math inline">\(\mathbf{x}(t^{\text{new}})\)</span> and the vector
<span class="math inline">\(\widehat{\boldsymbol{\psi}}\)</span> of the
estimated parameters.</p>
</div>
<div class="section level4">
<h4 id="ordinary-stationary-gev-model">Ordinary Stationary GEV model<a class="anchor" aria-label="anchor" href="#ordinary-stationary-gev-model"></a>
</h4>
<p>As a special case of TVGEV model, the ordinary stationary model is
obtained with all three GEV parameters being constant <span class="math inline">\(\boldsymbol{\theta}(t) =
\boldsymbol{\theta}\)</span> for all <span class="math inline">\(t\)</span>. Because the ML estimation and the
profile-likelihood inference of this model can be taken over by many R
packages, it will be used in the tests.</p>
</div>
</div>
<div class="section level3">
<h3 id="nsgev-package-features">NSGEV package features<a class="anchor" aria-label="anchor" href="#nsgev-package-features"></a>
</h3>
<div class="section level4">
<h4 id="maximum-likelihood">Maximum-likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood"></a>
</h4>
<p>Although the ML estimates can be obtained by several existing R
packages it was found convenient to have a log-likelihood maximisation
inside the package. Two choices are available via the <code>estim</code>
argument of the <code><a href="../reference/TVGEV.html">NSGEV::TVGEV</a></code> function.</p>
<ul>
<li><p><code>estim = "optim"</code> uses the classical optimisation
function <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code>, as do most EV packages. The gradient
is not used in this case.</p></li>
<li><p><code>estim = "nloptr"</code> uses the
<code><a href="https://rdrr.io/pkg/nloptr/man/nloptr.html" class="external-link">nloptr::nloptr</a></code> function. It uses the exact gradient of the
log-likelihood, which is computed by chain rule.</p></li>
</ul>
<p>The choice <code>estim = "nloptr"</code> should lead to a faster
optimisation because of the use of the gradient. Note that using the
gradient in ML estimation is not widespread among EV packages; the
<strong>extRemes</strong> packages seems to be only one to make use of
the gradients.</p>
</div>
<div class="section level4">
<h4 id="conditional-and-unconditional-prediction">Conditional and unconditional ‘prediction’<a class="anchor" aria-label="anchor" href="#conditional-and-unconditional-prediction"></a>
</h4>
<p>We speak of prediction although this term does not have its usual
statistical meaning; it is consistent with the use of the
<code>predict</code> method of R which produces some features of the
distribution of a “new” random variable, for instance moments.</p>
<ul>
<li><p>The <em>conditional</em> prediction relates to a specific
“target” or “new” block <span class="math inline">\(b^{\text{new}}\)</span> or to the corresponding
reference date <span class="math inline">\(t^{\text{new}}\)</span>. The
unknown vector <span class="math inline">\(\boldsymbol{\theta}^{\text{new}} :=
\boldsymbol{\theta}_{b^{\text{new}}}\)</span> of the GEV parameters can
be estimated, and along with its estimate we have an estimate <span class="math inline">\(\widehat{\rho}(m)\)</span> of the return level
corresponding to a given period of <span class="math inline">\(m\)</span> years <span class="math display">\[
\rho(m) := q_{\text{GEV}}(p;\, \boldsymbol{\theta}^{\text{new}}),
\qquad p := 1 - 1 / m.
\]</span></p></li>
<li><p>The <em>unconditional</em> or <em>integrated</em> prediction
relates to a period of time i.e., a collection of consecutive blocks
given by its start date and its end date e.g., the next century. The
Non-Stationary Return Level <span class="math inline">\(\rho_{\text{NS}}\)</span> of Parey et al. <span class="citation">(Parey, Sylvie and Hoang, Thi Thu Huong and
Dacunha-Castelle, Didier 2010)</span> is defined as the level <span class="math inline">\(\rho\)</span> such that the (random) number of
exceedances <span class="math inline">\(N\)</span> over <span class="math inline">\(\rho\)</span> has expectation <span class="math inline">\(1\)</span> on the chosen period.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="inference-profile-likelihood">Inference: profile-likelihood<a class="anchor" aria-label="anchor" href="#inference-profile-likelihood"></a>
</h4>
<p>The profile-likelihood method uses an original implementation
differing from the one usually retained. Given a confidence level <span class="math inline">\(1 - \alpha\)</span>, the usual method to find a
confidence interval on the return level <span class="math inline">\(\rho(m)\)</span> for a fixed period <span class="math inline">\(m\)</span> consists in the following steps.</p>
<ul>
<li><p>Re-parameterize the model by replacing one of the parameters by
<span class="math inline">\(\rho\)</span>. The constant <span class="math inline">\(\psi_{\mu,0}\)</span> in the inverse link for the
location <span class="math inline">\(\mu\)</span> is a good candidate
when it exists. The model now depends on <span class="math inline">\(\rho\)</span> and on the vector say <span class="math inline">\(\boldsymbol{\psi}_{-}\)</span> of the <span class="math inline">\(p-1\)</span> remaining parameters.</p></li>
<li><p>Consider the <em>profile log-likelihood</em> <span class="math inline">\(\ell_{\text{prof}}(\rho) := \log L[\rho,\,
\widehat{\boldsymbol{\psi}}_{-}(\rho)]\)</span>, where <span class="math inline">\(\widehat{\boldsymbol{\psi}}_{-}(\rho)\)</span> is
the value of <span class="math inline">\(\boldsymbol{\psi}_{-}\)</span>
maximizing <span class="math inline">\(\ell(\rho, \,
\boldsymbol{\psi}_{-})\)</span> with <span class="math inline">\(\rho\)</span> fixed. Then, find the values <span class="math inline">\(\rho\)</span> such that <span class="math display">\[ \ell_{\text{prof}}(\rho) = \max \ell - \delta
\]</span> where <span class="math inline">\(\delta\)</span> relates to
the quantile of the chi-square distribution with one degree of freedom
according to <span class="math inline">\(\delta := q_{\chi^2(1)}(1 -
\alpha) / 2\)</span>. Normally, two solutions <span class="math inline">\(\rho_{\text{L}}\)</span> and <span class="math inline">\(\rho_{\text{U}}\)</span> exist, one on both sides
of the ML estimate <span class="math inline">\(\widehat{\rho}\)</span>.
These solutions can be found by using a standard numerical method such
as that implemented in the <code>uniroot</code> function. Note that the
value of <span class="math inline">\(\widehat{\boldsymbol{\psi}}_{-}\)</span> depends
on <span class="math inline">\(\rho\)</span>, and that each evaluation
of the profile log-likelihood requires a <span class="math inline">\(p-1\)</span>-dimensional optimization.</p></li>
</ul>
<p>In <strong>NSGEV</strong>, we do not re-parameterise the model but
rather solve constrained optimization problems. The upper end-point
<span class="math inline">\(\rho_{\text{U}}\)</span> of the confidence
interval is found by solving</p>
<p><span class="math display">\[\begin{equation}
  \label{eq:OptimConstr}
  \begin{array}{l}  
   \underset{\boldsymbol{\psi}}{\max} \quad \rho(m; \boldsymbol{\psi})\\
   \text{s.t.} \quad \ell(\boldsymbol{\psi}) \geq \max \ell - \delta
   \end{array}
\end{equation}\]</span></p>
<p>where <span class="math inline">\(\delta\)</span> is as above. A
minimisation problem with the same constraint is solved to find the
lower end-point <span class="math inline">\(\rho_{\text{L}}\)</span>. In
both cases, we solve one constrained <span class="math inline">\(p\)</span>-dimensional problem.</p>
<p>A major advantage of this alternative approach is that it does not
require a re-parameterization. To a certain extend, we can consider that
the optimisation routine will perform automatically a local
re-parameterisation of the model in connection with the constraint. A
drawback is that the convergence of the constrained optimisation is more
difficult to check than that of the zero finding e.g., graphically.
However it can happen in the classical method that the <span class="math inline">\(p-1\)</span>-dimensional optimisation fails,
meaning that the profile-likelihood function evaluation is not correctly
evaluated, with possible consequences on the zero-finding task. It is
clear that the constraint in our method must be active at both optima,
which provides a possible convergence diagnostic.</p>
</div>
</div>
<div class="section level3">
<h3 id="other-r-packages">Other R packages<a class="anchor" aria-label="anchor" href="#other-r-packages"></a>
</h3>
<p>A number of other packages available on CRAN can be used to estimate
Time Varying GEV models as special cases of Non-Stationary GEV models.
Maybe the oldest of these, <strong>evd</strong> can only cope with a TV
location only, the scale and shape parameters being unknown but fixed.
Some packages can use more than one observation by block, a possibility
known under the name of <em><span class="math inline">\(r\)</span>-largest values</em> analysis. This is
not allowed in <strong>NSGEV</strong>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">package</th>
<th align="left">fun</th>
<th align="left">trend</th>
<th align="left">r.largest</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>climextRemes</strong></td>
<td align="left"><code>fit_gev</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left"><strong>evd</strong></td>
<td align="left"><code>fgev</code></td>
<td align="left"><em>loc only</em></td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left"><strong>eva</strong></td>
<td align="left"><code>gevrFit</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left"><strong>extRemes</strong></td>
<td align="left"><code>fevd</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left"><strong>ismev</strong></td>
<td align="left"><code>gev.fit</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left"><strong>ismev</strong></td>
<td align="left"><code>rlarg.fit</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left"><strong>NSGEV</strong></td>
<td align="left"><code>TVGEV</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
</tbody>
</table>
<p>The original features of <strong>NSGEV</strong> that are (to our best
knowledge) not found in other packages</p>
<ul>
<li><p>Return levels in the TV framework for a given origin.</p></li>
<li><p>Profile-likelihood confidence intervals on parameters and on
return levels.</p></li>
<li><p>Estimation and inference on the TV Return Level for a given
period of time.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="checks-and-comparisons">Checks and comparisons<a class="anchor" aria-label="anchor" href="#checks-and-comparisons"></a>
</h3>
<div class="section level4">
<h4 id="needs-and-limitations">Needs and limitations<a class="anchor" aria-label="anchor" href="#needs-and-limitations"></a>
</h4>
<ul>
<li><p>Check that the ML estimates are correct. It is impossible to get
the correct Maximum Likelihood using any TV model and any data. Thus we
expect that for data which are in good accordance with TV models having
slowly varying trend: Either the ML estimation will be successful, or a
non-convergence message will be given.</p></li>
<li><p>Check that the profile-likelihood based confidence intervals are
are correct, with the same limitation on data and models.</p></li>
</ul>
<p>In both cases, the results should be compared to those returned by
other EV packages. We will mainly use <strong>ismev</strong> <span class="citation">(Heffernan and Stephenson 2018)</span> and
<strong>extRemes</strong> <span class="citation">(Gilleland and Katz
2016)</span>, because they are often cited for the analysis of TV
models. Note that according to CRAN logs, <strong>evd</strong> <span class="citation">(Stephenson 2002)</span> remains (by far) the most
downloaded EV package from the CRAN.</p>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>A fist possibility is to reproduce examples from the literature: The
<strong>ismev</strong> package is shipped with several classical
datasets: <code>venice</code>, <code>portpirie</code>, … that have been
used in textbooks, articles or slideshows. As far as the results
obtained by <code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> are in good agreement with the
published results, we can use them as benchmark. A second possibility is
to use simulated data. In this case, that the data are necessarily in
good accordance with the model, but we do not know the ‘exact’ results
of ML estimation of profile-likelihood. We can then compare the results
provided by several packages.</p>
</div>
<div class="section level4">
<h4 id="reports">Reports<a class="anchor" aria-label="anchor" href="#reports"></a>
</h4>
<p>For now, the following reports are available.</p>
<ul>
<li><p><a href="simulatedBreaks.html"><em>Simulated trend
example</em></a> estimates the parameters from data generated by a TVGEV
model. The trend to be estimated is the same as the ‘true’ trend used to
generate the data.</p></li>
<li><p><a href="venice.html"><em>Venice example</em></a> was studied by
Coles <span class="citation">(Coles 2001)</span> and later (among
others) by Fawcett.</p></li>
<li><p><a href="profileLikelihood.html"><em>Profile-likelihood</em></a>
uses classical data sets from Stuart Coles’ book <span class="citation">(Coles 2001)</span> and compares the profile-likelihood
given by <strong>NSGEV</strong> to that given by
<strong>ismev</strong>.</p></li>
<li><p><a href="NSRL.html"><em>Non-Stationary Return Level</em></a> uses
a <code>TVGEV</code> model for the <code>Orange</code> data shipped with
<strong>NSGEV</strong> and simulations from this model to check that the
value of the RL computed by <code>predictUncond</code> is
correct.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="packages-used-in-the-reports">Packages used in the reports<a class="anchor" aria-label="anchor" href="#packages-used-in-the-reports"></a>
</h4>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): no package 'eva' was found</span></span></code></pre>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): no package 'evd' was found</span></span></code></pre>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Version</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>eva</strong></td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left"><strong>evd</strong></td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left"><strong>extRemes</strong></td>
<td align="left">2.1-3</td>
</tr>
<tr class="even">
<td align="left"><strong>ismev</strong></td>
<td align="left">1.42</td>
</tr>
<tr class="odd">
<td align="left"><strong>NSGEV</strong></td>
<td align="left">0.1.8</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Coles_ExtremeValues" class="csl-entry">
Coles, Suart. 2001. <em><span class="nocase">An Introduction to
Statistical Modelling of Extreme Values</span></em>. Springer. <a href="https://doi.org/10.1007/978-1-4471-3675-0" class="external-link">https://doi.org/10.1007/978-1-4471-3675-0</a>.
</div>
<div id="ref-Rpack_extRemes" class="csl-entry">
Gilleland, Eric, and Richard W. Katz. 2016. <span>“<span class="nocase">extRemes 2.0: An Extreme Value Analysis Package in
R</span>.”</span> <em>Journal of Statistical Software</em> 72 (8): 1–39.
<a href="https://doi.org/10.18637/jss.v072.i08" class="external-link">https://doi.org/10.18637/jss.v072.i08</a>.
</div>
<div id="ref-Rpack_ismev" class="csl-entry">
Heffernan, Janet E., and Alec G. Stephenson. 2018. <em><span class="nocase">ismev: An Introduction to Statistical Modeling of Extreme
Values</span></em>. <a href="https://CRAN.R-project.org/package=ismev" class="external-link">https://CRAN.R-project.org/package=ismev</a>.
</div>
<div id="ref-PareyEtAl_DifRetLev" class="csl-entry">
Parey, Sylvie and Hoang, Thi Thu Huong and Dacunha-Castelle, Didier.
2010. <span>“<span class="nocase">Different Ways to Compute Temperature
Return Levels in the Climate Change Context</span>.”</span>
<em>Environmetrics</em> 21 (7-8): 698–718. <a href="https://doi.org/10.1002/env.1060" class="external-link">https://doi.org/10.1002/env.1060</a>.
</div>
<div id="ref-Rpack_evd" class="csl-entry">
Stephenson, Alec G. 2002. <span>“<span class="nocase">evd: Extreme Value
Distributions</span>.”</span> <em>R News</em> 2 (2): 0. <a href="http://CRAN.R-project.org/doc/Rnews/" class="external-link">http://CRAN.R-project.org/doc/Rnews/</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
