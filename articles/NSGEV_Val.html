<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TVGEV: Checks ‚Ä¢ NSGEV</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="TVGEV: Checks">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="../articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="../articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="../articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
    <li>
      <a href="../articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>TVGEV: Checks</h1>
                        <h4 data-toc-skip class="author">Yves Deville,
Lise Bardet</h4>
            
            <h4 data-toc-skip class="date">2024-12-10</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/IRSN/NSGEV/blob/main/vignettes/NSGEV_Val.Rmd" class="external-link"><code>vignettes/NSGEV_Val.Rmd</code></a></small>
      <div class="hidden name"><code>NSGEV_Val.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="the-nsgev-package">The NSGEV Package<a class="anchor" aria-label="anchor" href="#the-nsgev-package"></a>
</h2>
<div class="section level3">
<h3 id="models">Models<a class="anchor" aria-label="anchor" href="#models"></a>
</h3>
<div class="section level4">
<h4 id="non-stationary-gev-models">Non-Stationary GEV models<a class="anchor" aria-label="anchor" href="#non-stationary-gev-models"></a>
</h4>
<p>The <strong>NSGEV</strong> package is dedicated to Non-Stationary
models with Generalized Extreme Value (GEV) observations which are often
called <em>Extreme Value Regression</em> models. These concern data with
observations attached to <em>blocks</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b = 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚Ä¶</mi><annotation encoding="application/x-tex">\dots</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>,
typically years. A response variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Y</mi><annotation encoding="application/x-tex">Y</annotation></semantics></math>
has one observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>b</mi></msub><annotation encoding="application/x-tex">Y_b</annotation></semantics></math>
for each block, which is typically a maximum reached within the block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>.
The response relates to a vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùê±</mi><annotation encoding="application/x-tex">\mathbf{x}</annotation></semantics></math>
of covariates with observations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mi>b</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_b</annotation></semantics></math>.
The
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
r.vs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Y</mi><mi>b</mi></msub><annotation encoding="application/x-tex">Y_b</annotation></semantics></math>
are assumed to be independent with GEV margin</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>b</mi></msub><mo>‚àº</mo><mtext mathvariant="normal">GEV</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Œº</mi><mi>b</mi></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>œÉ</mi><mi>b</mi></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>Œæ</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">
   Y_b \sim \text{GEV}(\mu_b,\,\sigma_b,\, \xi_b),
</annotation></semantics></math></p>
<p>and the three GEV parameters can depend on the covariates in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùê±</mi><mi>b</mi></msub><annotation encoding="application/x-tex">\mathbf{x}_b</annotation></semantics></math>
through a link function. For example with one covariate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>x</mi><mi>b</mi></msub><annotation encoding="application/x-tex">x_b</annotation></semantics></math>
we can use</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>b</mi></msub><mo>=</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>+</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>1</mn></mrow></msub><msub><mi>x</mi><mi>b</mi></msub><mo>,</mo></mrow><annotation encoding="application/x-tex">
  \mu_b = \psi_{\mu,0} + \psi_{\mu, 1} x_b,         
</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">\psi_{\mu,0}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>1</mn></mrow></msub><annotation encoding="application/x-tex">\psi_{\mu, 1}</annotation></semantics></math>
are parameters to be estimated. The pseudo-index
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œà</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
is used to show which GEV parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œà</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
relates to. We can have similarly a formula and a link for the scale
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÉ</mi><annotation encoding="application/x-tex">\sigma</annotation></semantics></math>
and even for the shape
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œæ</mi><annotation encoding="application/x-tex">\xi</annotation></semantics></math>,
leading to parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>œÉ</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\psi_{\sigma,i}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>Œæ</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\psi_{\xi,i}</annotation></semantics></math>.</p>
<p>An alternative notation for the GEV distribution uses the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ùõâ</mi><mi>b</mi></msub><mo>:=</mo><mrow><mo stretchy="true" form="prefix">[</mo><msub><mi>Œº</mi><mi>b</mi></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>œÉ</mi><mi>b</mi></msub><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>Œæ</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}_b := [\mu_b,\,\sigma_b,\,\xi_b]</annotation></semantics></math>
and writes
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Y</mi><mi>b</mi></msub><mo>‚àº</mo><mtext mathvariant="normal">GEV</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>ùõâ</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y_b
\sim \text{GEV}(\boldsymbol{\theta}_b)</annotation></semantics></math>.
The GEV parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Œ∏</mi><mrow><mi>b</mi><mo>,</mo><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\theta_{b,i}</annotation></semantics></math>
which depend on the block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
should not be confused with the parameters
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œà</mi><annotation encoding="application/x-tex">\psi</annotation></semantics></math>
of the model, which do not depend on the block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="time-varying-gev-models">Time-Varying GEV models<a class="anchor" aria-label="anchor" href="#time-varying-gev-models"></a>
</h4>
<p>This report mainly focuses on <em>Time-Varying</em> models which are
the main concern in the package, and are used as objects of a S3 class
named <code>"TVGEV"</code>. In this setting, the blocks are assumed to
have the <em>same duration</em>; Moreover, attached with each block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
we have a <em>date</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>b</mi></msub><annotation encoding="application/x-tex">t_b</annotation></semantics></math>
which can conveniently chosen as the beginning of the block. The GEV
parameters are now linked to covariates which are deterministic
functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>x</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x(t_b)</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>b</mi></msub><annotation encoding="application/x-tex">t_b</annotation></semantics></math>.
For instance, a quadratic trend can be used for the location parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Œº</mi><mi>b</mi></msub><mo>=</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>0</mn></mrow></msub><mo>+</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>1</mn></mrow></msub><mspace width="0.167em"></mspace><msub><mi>t</mi><mi>b</mi></msub><mo>+</mo><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>2</mn></mrow></msub><mspace width="0.167em"></mspace><msubsup><mi>t</mi><mi>b</mi><mn>2</mn></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex"> 
  \mu_b = \psi_{\mu, 0} + \psi_{\mu,1} \, t_b + \psi_{\mu,2} \,t_b^2.
</annotation></semantics></math></p>
<p>An implicit assumption is that <em>the GEV parameters should vary
slowly</em>, with only very small variation from a block to the next
one. So the choice of a specific reference date
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>b</mi></msub><annotation encoding="application/x-tex">t_b</annotation></semantics></math>
within the block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
does not really matter. We can think of the vector of GEV parameters as
a time-varying
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõâ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}(t)</annotation></semantics></math>
with a slow variation.</p>
<p>For <code>TVGEV</code> models, we assume that each GEV parameter is
linked to a linear combination of the trend functions having the form
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùê±</mi><msup><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>b</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>‚ä§</mi></msup><mi>ùõô</mi></mrow><annotation encoding="application/x-tex">\mathbf{x}(t_b)^\top \boldsymbol{\psi}</annotation></semantics></math>.
The standard R formulas for linear models can be used to specify the
dependence of each GEV parameter on the basis covariates via an object
with class <code>"formula"</code>.</p>
<p>Although Time-Varying models may appear as special cases of more
general Non-Stationary models, they deserve a special treatment because
it is often a concern then to make special ‚Äòpredictions‚Äô in relation
with a period of time or an origin.</p>
<p><em>Remark</em>. Choosing the begining of a block as reference date
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>b</mi></msub><annotation encoding="application/x-tex">t_b</annotation></semantics></math>
is convenient because the it is easy to convert a year number and a
reference date are easily converted into each other.</p>
</div>
<div class="section level4">
<h4 id="designs">Designs<a class="anchor" aria-label="anchor" href="#designs"></a>
</h4>
<p>Within the package are ‚Äúdesign functions‚Äù which provide bases of
functions. A basis consist in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
linearly independent functions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x_k(t)</annotation></semantics></math>
of the date
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
forming a covariate vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùê±</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x}(t)</annotation></semantics></math>
of length
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
with elements</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>x</mi><mn>1</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="0.167em"></mspace><mi>‚Ä¶</mi><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>x</mi><mrow><mi>r</mi><mo>‚àí</mo><mn>1</mn></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">
    x_0(t), \, x_1(t), \, \dots, \,x_{r-1}(t).  
</annotation></semantics></math></p>
<p>By evaluating the basis functions at the reference dates
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>t</mi><mi>b</mi></msub><annotation encoding="application/x-tex">t_b</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">b=1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>2</mn><annotation encoding="application/x-tex">2</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>‚Ä¶</mi><annotation encoding="application/x-tex">\dots</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
we get a ‚Äúdesign‚Äù matrix
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ùêó</mi><annotation encoding="application/x-tex">\mathbf{X}</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>B</mi><annotation encoding="application/x-tex">B</annotation></semantics></math>
rows and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>
columns as in a linear regression framework. As suggested by the use of
a zero index, a basis might embed the constant function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>0</mn></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">x_0(t) = 1</annotation></semantics></math>.
For a polynomial basis, we can take
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><msup><mi>t</mi><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">x_k(t) :=
t^k</annotation></semantics></math> for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">k=0</annotation></semantics></math>
to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">r-1</annotation></semantics></math>.
However it is often necessary to scale the basis functions because they
can otherwise take large values, which can cause problems in likelihood
maximisation. A simple and widely adopted precaution consists in
changing the origin, i.e.¬†in using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>k</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>‚àí</mo><msup><mi>t</mi><mo>‚ãÜ</mo></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>k</mi></msup></mrow><annotation encoding="application/x-tex">x_k(t) := (t - t^\star)^k</annotation></semantics></math>
for some chosen origin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mo>‚ãÜ</mo></msup><annotation encoding="application/x-tex">t^\star</annotation></semantics></math>.
By taking the origin
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mo>‚ãÜ</mo></msup><annotation encoding="application/x-tex">t^\star</annotation></semantics></math>
as roughly located at the centre of the time period used in the fit will
neatly facilitate the estimation.</p>
<p>For now, the design functions include: <em>polynomial</em> basis,
<em>natural spline</em> basis, and (continuous) broken line basis. Using
the broken line basis, it is possible to specify a <em>kink
regression</em>, but only with a known date for the change of slope.</p>
<p>In <strong>NSGEV</strong>, the definition of the design function used
by a TVGEV model is attached to the R object representing a fitted
model. So for a given ‚Äúnew‚Äù block given its reference date
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mtext mathvariant="normal">new</mtext></msup><annotation encoding="application/x-tex">t^{\text{new}}</annotation></semantics></math>
we can straightforwardly obtain the estimated
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>ùõâ</mi><mo accent="true">ÃÇ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>t</mi><mtext mathvariant="normal">new</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widehat{\boldsymbol{\theta}}(t^{\text{new}})</annotation></semantics></math>
from the covariate vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùê±</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>t</mi><mtext mathvariant="normal">new</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\mathbf{x}(t^{\text{new}})</annotation></semantics></math>
and the vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>ùõô</mi><mo accent="true">ÃÇ</mo></mover><annotation encoding="application/x-tex">\widehat{\boldsymbol{\psi}}</annotation></semantics></math>
of the estimated parameters.</p>
</div>
<div class="section level4">
<h4 id="ordinary-stationary-gev-model">Ordinary Stationary GEV model<a class="anchor" aria-label="anchor" href="#ordinary-stationary-gev-model"></a>
</h4>
<p>As a special case of TVGEV model, the ordinary stationary model is
obtained with all three GEV parameters being constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ùõâ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>ùõâ</mi></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}(t) = \boldsymbol{\theta}</annotation></semantics></math>
for all
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>.
Because the ML estimation and the profile-likelihood inference of this
model can be taken over by many R packages, it will be used in the
tests.</p>
</div>
</div>
<div class="section level3">
<h3 id="nsgev-package-features">NSGEV package features<a class="anchor" aria-label="anchor" href="#nsgev-package-features"></a>
</h3>
<div class="section level4">
<h4 id="maximum-likelihood">Maximum-likelihood<a class="anchor" aria-label="anchor" href="#maximum-likelihood"></a>
</h4>
<p>Although the ML estimates can be obtained by several existing R
packages it was found convenient to have a log-likelihood maximisation
inside the package. Two choices are available via the <code>estim</code>
argument of the <code><a href="../reference/TVGEV.html">NSGEV::TVGEV</a></code> function.</p>
<ul>
<li><p><code>estim = "optim"</code> uses the classical optimisation
function <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code>, as do most EV packages. The gradient
is not used in this case.</p></li>
<li><p><code>estim = "nloptr"</code> uses the
<code><a href="https://astamm.github.io/nloptr/reference/nloptr.html" class="external-link">nloptr::nloptr</a></code> function. It uses the exact gradient of the
log-likelihood, which is computed by chain rule.</p></li>
</ul>
<p>The choice <code>estim = "nloptr"</code> should lead to a faster
optimisation because of the use of the gradient. Note that using the
gradient in ML estimation is not widespread among EV packages; the
<strong>extRemes</strong> packages seems to be only one to make use of
the gradients.</p>
</div>
<div class="section level4">
<h4 id="conditional-and-unconditional-prediction">Conditional and unconditional ‚Äòprediction‚Äô<a class="anchor" aria-label="anchor" href="#conditional-and-unconditional-prediction"></a>
</h4>
<p>We speak of prediction although this term does not have its usual
statistical meaning; it is consistent with the use of the
<code>predict</code> method of R which produces some features of the
distribution of a ‚Äúnew‚Äù random variable, for instance moments.</p>
<ul>
<li><p>The <em>conditional</em> prediction relates to a specific
‚Äútarget‚Äù or ‚Äúnew‚Äù block
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>b</mi><mtext mathvariant="normal">new</mtext></msup><annotation encoding="application/x-tex">b^{\text{new}}</annotation></semantics></math>
or to the corresponding reference date
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>t</mi><mtext mathvariant="normal">new</mtext></msup><annotation encoding="application/x-tex">t^{\text{new}}</annotation></semantics></math>.
The unknown vector
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>ùõâ</mi><mtext mathvariant="normal">new</mtext></msup><mo>:=</mo><msub><mi>ùõâ</mi><msup><mi>b</mi><mtext mathvariant="normal">new</mtext></msup></msub></mrow><annotation encoding="application/x-tex">\boldsymbol{\theta}^{\text{new}} :=
\boldsymbol{\theta}_{b^{\text{new}}}</annotation></semantics></math> of
the GEV parameters can be estimated, and along with its estimate we have
an estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widehat{\rho}(m)</annotation></semantics></math>
of the return level corresponding to a given period of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
years
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><msub><mi>q</mi><mtext mathvariant="normal">GEV</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>p</mi><mo>;</mo><mspace width="0.167em"></mspace><msup><mi>ùõâ</mi><mtext mathvariant="normal">new</mtext></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="2.0em"></mspace><mi>p</mi><mo>:=</mo><mn>1</mn><mo>‚àí</mo><mn>1</mn><mi>/</mi><mi>m</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">
\rho(m) := q_{\text{GEV}}(p;\, \boldsymbol{\theta}^{\text{new}}),
\qquad p := 1 - 1 / m.
</annotation></semantics></math></p></li>
<li><p>The <em>unconditional</em> or <em>integrated</em> prediction
relates to a period of time i.e., a collection of consecutive blocks
given by its start date and its end date e.g., the next century. The
Non-Stationary Return Level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mtext mathvariant="normal">NS</mtext></msub><annotation encoding="application/x-tex">\rho_{\text{NS}}</annotation></semantics></math>
of Parey et al. <span class="citation">(Parey, Sylvie and Hoang, Thi Thu
Huong and Dacunha-Castelle, Didier 2010)</span> is defined as the level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
such that the (random) number of exceedances
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>N</mi><annotation encoding="application/x-tex">N</annotation></semantics></math>
over
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
has expectation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>1</mn><annotation encoding="application/x-tex">1</annotation></semantics></math>
on the chosen period.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="inference-profile-likelihood">Inference: profile-likelihood<a class="anchor" aria-label="anchor" href="#inference-profile-likelihood"></a>
</h4>
<p>The profile-likelihood method uses an original implementation
differing from the one usually retained. Given a confidence level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>‚àí</mo><mi>Œ±</mi></mrow><annotation encoding="application/x-tex">1 -
\alpha</annotation></semantics></math>, the usual method to find a
confidence interval on the return level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho(m)</annotation></semantics></math>
for a fixed period
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
consists in the following steps.</p>
<ul>
<li><p>Re-parameterize the model by replacing one of the parameters by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>.
The constant
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œà</mi><mrow><mi>Œº</mi><mo>,</mo><mn>0</mn></mrow></msub><annotation encoding="application/x-tex">\psi_{\mu,0}</annotation></semantics></math>
in the inverse link for the location
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œº</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
is a good candidate when it exists. The model now depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
and on the vector say
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùõô</mi><mo>‚àí</mo></msub><annotation encoding="application/x-tex">\boldsymbol{\psi}_{-}</annotation></semantics></math>
of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math>
remaining parameters.</p></li>
<li><p>Consider the <em>profile log-likelihood</em>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚Ñì</mo><mtext mathvariant="normal">prof</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>:=</mo><mo>log</mo><mi>L</mi><mrow><mo stretchy="true" form="prefix">[</mo><mi>œÅ</mi><mo>,</mo><mspace width="0.167em"></mspace><msub><mover><mi>ùõô</mi><mo accent="true">ÃÇ</mo></mover><mo>‚àí</mo></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">]</mo></mrow></mrow><annotation encoding="application/x-tex">\ell_{\text{prof}}(\rho) :=
\log L[\rho,\, \widehat{\boldsymbol{\psi}}_{-}(\rho)]</annotation></semantics></math>,
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover><mi>ùõô</mi><mo accent="true">ÃÇ</mo></mover><mo>‚àí</mo></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\widehat{\boldsymbol{\psi}}_{-}(\rho)</annotation></semantics></math>
is the value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ùõô</mi><mo>‚àí</mo></msub><annotation encoding="application/x-tex">\boldsymbol{\psi}_{-}</annotation></semantics></math>
maximizing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>‚Ñì</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo>,</mo><mspace width="0.167em"></mspace><msub><mi>ùõô</mi><mo>‚àí</mo></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\ell(\rho, \,
\boldsymbol{\psi}_{-})</annotation></semantics></math> with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
fixed. Then, find the values
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mo>‚Ñì</mo><mtext mathvariant="normal">prof</mtext></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>œÅ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>max</mo><mo>‚Ñì</mo><mo>‚àí</mo><mi>Œ¥</mi></mrow><annotation encoding="application/x-tex"> \ell_{\text{prof}}(\rho) = \max \ell - \delta </annotation></semantics></math>
where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ¥</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
relates to the quantile of the chi-square distribution with one degree
of freedom according to
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Œ¥</mi><mo>:=</mo><msub><mi>q</mi><mrow><msup><mi>œá</mi><mn>2</mn></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>‚àí</mo><mi>Œ±</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">\delta :=
q_{\chi^2(1)}(1 - \alpha) / 2</annotation></semantics></math>. Normally,
two solutions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mtext mathvariant="normal">L</mtext></msub><annotation encoding="application/x-tex">\rho_{\text{L}}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mtext mathvariant="normal">U</mtext></msub><annotation encoding="application/x-tex">\rho_{\text{U}}</annotation></semantics></math>
exist, one on both sides of the ML estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mover><mi>œÅ</mi><mo accent="true">ÃÇ</mo></mover><annotation encoding="application/x-tex">\widehat{\rho}</annotation></semantics></math>.
These solutions can be found by using a standard numerical method such
as that implemented in the <code>uniroot</code> function. Note that the
value of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>ùõô</mi><mo accent="true">ÃÇ</mo></mover><mo>‚àí</mo></msub><annotation encoding="application/x-tex">\widehat{\boldsymbol{\psi}}_{-}</annotation></semantics></math>
depends on
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>œÅ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>,
and that each evaluation of the profile log-likelihood requires a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math>-dimensional
optimization.</p></li>
</ul>
<p>In <strong>NSGEV</strong>, we do not re-parameterise the model but
rather solve constrained optimization problems. The upper end-point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mtext mathvariant="normal">U</mtext></msub><annotation encoding="application/x-tex">\rho_{\text{U}}</annotation></semantics></math>
of the confidence interval is found by solving</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="left" style="text-align: left"><munder><mo>max</mo><mi>ùõô</mi></munder><mspace width="1.0em"></mspace><mi>œÅ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>m</mi><mo>;</mo><mi>ùõô</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">s.t.</mtext><mspace width="1.0em"></mspace><mo>‚Ñì</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>ùõô</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚â•</mo><mo>max</mo><mo>‚Ñì</mo><mo>‚àí</mo><mi>Œ¥</mi></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{equation}
  \label{eq:OptimConstr}
  \begin{array}{l}  
   \underset{\boldsymbol{\psi}}{\max} \quad \rho(m; \boldsymbol{\psi})\\
   \text{s.t.} \quad \ell(\boldsymbol{\psi}) \geq \max \ell - \delta
   \end{array}
\end{equation}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Œ¥</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
is as above. A minimisation problem with the same constraint is solved
to find the lower end-point
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>œÅ</mi><mtext mathvariant="normal">L</mtext></msub><annotation encoding="application/x-tex">\rho_{\text{L}}</annotation></semantics></math>.
In both cases, we solve one constrained
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>-dimensional
problem.</p>
<p>A major advantage of this alternative approach is that it does not
require a re-parameterization. To a certain extend, we can consider that
the optimisation routine will perform automatically a local
re-parameterisation of the model in connection with the constraint. A
drawback is that the convergence of the constrained optimisation is more
difficult to check than that of the zero finding e.g., graphically.
However it can happen in the classical method that the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mo>‚àí</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">p-1</annotation></semantics></math>-dimensional
optimisation fails, meaning that the profile-likelihood function
evaluation is not correctly evaluated, with possible consequences on the
zero-finding task. It is clear that the constraint in our method must be
active at both optima, which provides a possible convergence
diagnostic.</p>
</div>
</div>
<div class="section level3">
<h3 id="other-r-packages">Other R packages<a class="anchor" aria-label="anchor" href="#other-r-packages"></a>
</h3>
<p>A number of other packages available on CRAN can be used to estimate
Time Varying GEV models as special cases of Non-Stationary GEV models.
Maybe the oldest of these, <strong>evd</strong> can only cope with a TV
location only, the scale and shape parameters being unknown but fixed.
Some packages can use more than one observation by block, a possibility
known under the name of
<em><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>r</mi><annotation encoding="application/x-tex">r</annotation></semantics></math>-largest
values</em> analysis. This is not allowed in <strong>NSGEV</strong>.</p>
<table class="table">
<thead><tr class="header">
<th align="left">package</th>
<th align="left">fun</th>
<th align="left">trend</th>
<th align="left">r.largest</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>climextRemes</strong></td>
<td align="left"><code>fit_gev</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left"><strong>evd</strong></td>
<td align="left"><code>fgev</code></td>
<td align="left"><em>loc only</em></td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left"><strong>eva</strong></td>
<td align="left"><code>gevrFit</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left"><strong>extRemes</strong></td>
<td align="left"><code>fevd</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left"><strong>ismev</strong></td>
<td align="left"><code>gev.fit</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left"><strong>ismev</strong></td>
<td align="left"><code>rlarg.fit</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left"><strong>NSGEV</strong></td>
<td align="left"><code>TVGEV</code></td>
<td align="left">loc, scale, shape</td>
<td align="left">no</td>
</tr>
</tbody>
</table>
<p>The original features of <strong>NSGEV</strong> that are (to our best
knowledge) not found in other packages</p>
<ul>
<li><p>Return levels in the TV framework for a given origin.</p></li>
<li><p>Profile-likelihood confidence intervals on parameters and on
return levels.</p></li>
<li><p>Estimation and inference on the TV Return Level for a given
period of time.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="checks-and-comparisons">Checks and comparisons<a class="anchor" aria-label="anchor" href="#checks-and-comparisons"></a>
</h3>
<div class="section level4">
<h4 id="needs-and-limitations">Needs and limitations<a class="anchor" aria-label="anchor" href="#needs-and-limitations"></a>
</h4>
<ul>
<li><p>Check that the ML estimates are correct. It is impossible to get
the correct Maximum Likelihood using any TV model and any data. Thus we
expect that for data which are in good accordance with TV models having
slowly varying trend: Either the ML estimation will be successful, or a
non-convergence message will be given.</p></li>
<li><p>Check that the profile-likelihood based confidence intervals are
are correct, with the same limitation on data and models.</p></li>
</ul>
<p>In both cases, the results should be compared to those returned by
other EV packages. We will mainly use <strong>ismev</strong> <span class="citation">(<strong>Rpack_ismev?</strong>)</span> and
<strong>extRemes</strong> <span class="citation">(Gilleland and Katz
2016)</span>, because they are often cited for the analysis of TV
models. Note that according to CRAN logs, <strong>evd</strong> <span class="citation">(Stephenson 2002)</span> remains (by far) the most
downloaded EV package from the CRAN.</p>
</div>
<div class="section level4">
<h4 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h4>
<p>A fist possibility is to reproduce examples from the literature: The
<strong>ismev</strong> package is shipped with several classical
datasets: <code>venice</code>, <code>portpirie</code>, ‚Ä¶ that have been
used in textbooks, articles or slideshows. As far as the results
obtained by <code><a href="https://rdrr.io/pkg/ismev/man/gev.fit.html" class="external-link">ismev::gev.fit</a></code> are in good agreement with the
published results, we can use them as benchmark. A second possibility is
to use simulated data. In this case, that the data are necessarily in
good accordance with the model, but we do not know the ‚Äòexact‚Äô results
of ML estimation of profile-likelihood. We can then compare the results
provided by several packages.</p>
</div>
<div class="section level4">
<h4 id="reports">Reports<a class="anchor" aria-label="anchor" href="#reports"></a>
</h4>
<p>For now, the following reports are available.</p>
<ul>
<li><p><a href="simulatedBreaks.html"><em>Simulated trend
example</em></a> estimates the parameters from data generated by a TVGEV
model. The trend to be estimated is the same as the ‚Äòtrue‚Äô trend used to
generate the data.</p></li>
<li><p><a href="venice.html"><em>Venice example</em></a> was studied by
Coles <span class="citation">(Coles 2001)</span> and later (among
others) by Fawcett.</p></li>
<li><p><a href="profileLikelihood.html"><em>Profile-likelihood</em></a>
uses classical data sets from Stuart Coles‚Äô book <span class="citation">(Coles 2001)</span> and compares the profile-likelihood
given by <strong>NSGEV</strong> to that given by
<strong>ismev</strong>.</p></li>
<li><p><a href="NSRL.html"><em>Non-Stationary Return Level</em></a> uses
a <code>TVGEV</code> model for the <code>Orange</code> data shipped with
<strong>NSGEV</strong> and simulations from this model to check that the
value of the RL computed by <code>predictUncond</code> is
correct.</p></li>
</ul>
</div>
<div class="section level4">
<h4 id="packages-used-in-the-reports">Packages used in the reports<a class="anchor" aria-label="anchor" href="#packages-used-in-the-reports"></a>
</h4>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): no package 'eva' was found</span></span></code></pre>
<pre><code><span><span class="co">## Warning in FUN(X[[i]], ...): no package 'evd' was found</span></span></code></pre>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="left">Version</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><strong>eva</strong></td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left"><strong>evd</strong></td>
<td align="left">NA</td>
</tr>
<tr class="odd">
<td align="left"><strong>extRemes</strong></td>
<td align="left">2.2</td>
</tr>
<tr class="even">
<td align="left"><strong>ismev</strong></td>
<td align="left">1.42</td>
</tr>
<tr class="odd">
<td align="left"><strong>NSGEV</strong></td>
<td align="left">0.2.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-Coles_ExtremeValues" class="csl-entry">
Coles, Suart. 2001. <em><span class="nocase">An Introduction to
Statistical Modeling of Extreme Values</span></em>. Springer. <a href="https://doi.org/10.1007/978-1-4471-3675-0" class="external-link">https://doi.org/10.1007/978-1-4471-3675-0</a>.
</div>
<div id="ref-Rpack_extRemes" class="csl-entry">
Gilleland, Eric, and Richard W. Katz. 2016. <span>‚Äú<span class="nocase">extRemes 2.0: An Extreme Value Analysis Package in
R</span>.‚Äù</span> <em>Journal of Statistical Software</em> 72 (8): 1‚Äì39.
<a href="https://doi.org/10.18637/jss.v072.i08" class="external-link">https://doi.org/10.18637/jss.v072.i08</a>.
</div>
<div id="ref-PareyEtAl_DifRetLev" class="csl-entry">
Parey, Sylvie and Hoang, Thi Thu Huong and Dacunha-Castelle, Didier.
2010. <span>‚Äú<span class="nocase">Different Ways to Compute Temperature
Return Levels in the Climate Change Context</span>.‚Äù</span>
<em>Environmetrics</em> 21 (7-8): 698‚Äì718. <a href="https://doi.org/10.1002/env.1060" class="external-link">https://doi.org/10.1002/env.1060</a>.
</div>
<div id="ref-Rpack_evd" class="csl-entry">
Stephenson, Alec G. 2002. <span>‚Äú<span class="nocase">evd: Extreme Value
Distributions</span>.‚Äù</span> <em><span>The R Journal</span></em> 2 (2):
0. <a href="http://CRAN.R-project.org/doc/Rnews/" class="external-link">http://CRAN.R-project.org/doc/Rnews/</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
