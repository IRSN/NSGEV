<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Prediction of Unconditional or Non-Stationary Return Levels for a TVGEV or a NSGEV Object — predictUncond • NSGEV</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Prediction of Unconditional or Non-Stationary Return Levels for a TVGEV or a NSGEV Object — predictUncond"><meta property="og:description" content="Prediction of Unconditional or Non-Stationary Return Levels for a
TVGEV or a NSGEV object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="../articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="../articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="../articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="../articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
    <li>
      <a href="../articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Prediction of Unconditional or Non-Stationary Return Levels for a <code>TVGEV</code> or a <code>NSGEV</code> Object</h1>
    <small class="dont-index">Source: <a href="https://github.com/IRSN/NSGEV/blob/0.2.0/R/predictUncond.R" class="external-link"><code>R/predictUncond.R</code></a></small>
    <div class="hidden name"><code>predictUncond.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Prediction of Unconditional or Non-Stationary Return Levels for a
<code>TVGEV</code> or a <code>NSGEV</code> object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">predictUncond</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  period <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdateFrom <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  resample <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  RLType <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"exceed"</span>, <span class="st">"average"</span><span class="op">)</span>,</span>
<span>  confintMethod <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"delta"</span>, <span class="st">"none"</span>, <span class="st">"boot"</span>, <span class="st">"proflik"</span><span class="op">)</span>,</span>
<span>  out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"data.frame"</span>, <span class="st">"array"</span><span class="op">)</span>,</span>
<span>  trace <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>A <code>TVGEV</code> or a <code>NSGEV</code> model object.</p></dd>


<dt id="arg-period">period<a class="anchor" aria-label="anchor" href="#arg-period"></a></dt>
<dd><p>A numeric vector giving the periods at which the
Return Levels will be computed.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>The Confidence Levels at which the CI will be
computed.  For <code>"proflik"</code> CI, only one level can be given
for now.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>Only for a <code>NSGEV</code> model. A data frame
containing the covariates needed. Each row represents a block with
unit duration.</p></dd>


<dt id="arg-newdate">newdate<a class="anchor" aria-label="anchor" href="#arg-newdate"></a></dt>
<dd><p>Only for a <code>TVGEV</code> model. This argument is
essentially for compatibility with the <code>predict</code> method for
unconditional prediction. A vector that can be coerced to the
<code>"Date"</code> class. This vector define \(B\) blocks used to
compute the return levels. The standard use is is with consecutive
blocks, so the specification should <em>use the</em>
<code>newdateFrom</code> <em>formal argument rather than</em> <code>newdate</code>.</p></dd>


<dt id="arg-newdatefrom">newdateFrom<a class="anchor" aria-label="anchor" href="#arg-newdatefrom"></a></dt>
<dd><p>Only for a <code>TVGEV</code> model. A vector with
length one that can be coerced to the <code>"Date"</code> class. This
gives the first block of a period of \(B\) successive blocks
used to compute the Return Levels, where \(B\) is the maximal
period defined in <code>period</code>.</p></dd>


<dt id="arg-resample">resample<a class="anchor" aria-label="anchor" href="#arg-resample"></a></dt>
<dd><p>Not used yet. See the <code><a href="RL.html">RL</a></code>
function. For now, the RL period that are greater than
<code>nrow(newdata)</code> are discarded in the computation.</p></dd>


<dt id="arg-rltype">RLType<a class="anchor" aria-label="anchor" href="#arg-rltype"></a></dt>
<dd><p>The type of Return Level as in <code><a href="RL.html">RL</a></code>.</p></dd>


<dt id="arg-confintmethod">confintMethod<a class="anchor" aria-label="anchor" href="#arg-confintmethod"></a></dt>
<dd><p>The type of Confidence Interval (CI) to
compute.  The value <code>"delta"</code> leads to using the <em>delta
method</em>, and <code>"proflik"</code> leads to using the
profile-likelihood method.</p></dd>


<dt id="arg-out">out<a class="anchor" aria-label="anchor" href="#arg-out"></a></dt>
<dd><p>Type of output.</p></dd>


<dt id="arg-trace">trace<a class="anchor" aria-label="anchor" href="#arg-trace"></a></dt>
<dd><p>Level of verbosity.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Not used yet.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A data frame with the predicted RLs and the related CIs,
with one row by block.</p>
<p>This data frame can have several attributes</p>
<ul><li><p><code>title</code> is a string that can be used as title in plots.</p></li>
<li><p><code>diagno</code>. When <code>confInt</code> is equal to
<code>"proflik"</code>, this element is an array providing information
about the optimisation.</p></li>
<li><p><code>PsiStar</code>. When <code>confInt</code> is equal to
<code>"proflik"</code>, this element is a matrix with its row \(i\)
giving the value \(\boldsymbol{\psi}^\star\) of the vector
of parameters that maximizes the Return Level \(\rho(T)\) with
period \(T = T_i\) under the constraint on the log-likelihood.</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p>For a Non-Stationary GEV model, the Return Level corresponding to
a given period (e.g. 100 years) depends on the value of the
covariates. However we can make an assumption on the the
distribution of the covariates to compute an uncondtitional Return
Level as the expectation of the RL. Similarily, for Time-Varying
<code>TVGEV</code> models we can define the Return Level as the level
for which the expected number of exceedances on a reference period
of time is equal to one, see <code><a href="RL.html">RL</a></code>. In both cases, the RL
no longer depends of the covariates or on a specific block.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>For the profile-likelihood method, the determination of the
confidence intervals is quite slow because a constrained
optimization problem is solved for each period.</p>
<p>Since most often the values of \(\boldsymbol{\psi}^\star\)
corresponding to different periods are close enough, a significant
reduction of the computing time could be achieved in the near
future by using the same value of \(\boldsymbol{\psi}\)
for all the Return Periods.</p>
<p>Future versions might allow different durations across blocks by
using dedicated arguments. For now, it must be kept in mind that
the periods are understood as multiple of a constant block
duration. So if <code>newdata</code> has <code>100</code> rows the maximal
Return Period that can be used without resampling is <code>100</code>.</p>
    </div>
    <div id="caution">
    <h2>Caution</h2>


<ul><li><p>When <code>period</code> contains some large values, say 100 or
more, a massive extrapolation from the model is required to
compute the corresponding RLs. This is likely to be meaningless
from a statistical point of view, because a massive extrapolation
of regression-like model does not make sense. The interest should
rather focus on a moderately large period.</p></li>
<li><p>For each period \(T\), the Return Level is computed using
the \(T\) blocks \(t_0\), \(t_0 + 1\), ..., \(t_0 + T -1\)
so the different periods \(T\) appearing on a Return Level plot
correspond to different prediction horizons. As a result, the
quantile or confidence bounds do not depend as smoothly of \(T\)
as they do for conditional predictions.</p></li>
</ul></div>
    <div id="author">
    <h2>Author</h2>
    <p>Yves Deville</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/example.html" class="external-link">example</a></span><span class="op">(</span><span class="va">TVGEV</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## transform a numeric year into a date</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; df &lt;- within(TXMax_Dijon, Date &lt;- as.Date(sprintf("%4d-01-01", Year)))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; df0 &lt;- subset(df, !is.na(TXMax))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## fit a TVGEV model. Only the location parameter is TV.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t1 &lt;- system.time(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+     res1 &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   design = breaksX(date = Date, breaks = "1970-01-01", degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   loc = ~ t1 + t1_1970))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## The same using "nloptr" optimisation.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t2 &lt;- system.time(</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+     res2 &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   design = breaksX(date = Date, breaks = "1970-01-01", degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   loc = ~ t1 + t1_1970,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   estim = "nloptr",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                   parTrack = TRUE))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## use extRemes::fevd the required variables need to be added to the data frame</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## passed as 'data' argument</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; t0 &lt;- system.time({</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+    df0.evd &lt;- cbind(df0, breaksX(date = df0$Date, breaks = "1970-01-01",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+                     degree = 1));</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+    res0 &lt;- fevd(x = df0.evd$TXMax, data = df0.evd, loc = ~ t1 + t1_1970)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+  })</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## compare estimate and negative log-liks</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; cbind("fevd" = res0$results$par,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_optim" = res1$estimate,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_nloptr" = res2$estimate)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              fevd TVGEV_optim TVGEV_nloptr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu0   32.06678895 32.06638460  32.06679282</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu1   -0.02391857 -0.02392656  -0.02391856</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mu2    0.07727041  0.07728411   0.07727061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> scale  1.75585289  1.75541862   1.75585353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> shape -0.18130928 -0.18112018  -0.18131041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; cbind("fevd" = res0$results$value,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "VGEV_optim" = res1$negLogLik,</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV+       "TVGEV_nloptr" = res2$negLogLik)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          fevd VGEV_optim TVGEV_nloptr</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 177.2014   177.2014     177.2014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## ====================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## use a loop on plausible break years. The fitted models</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## are stored within a list</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## ====================================================================</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## Not run: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     yearBreaks &lt;- c(1940, 1950, 1955, 1960:2000, 2005, 2010)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     res &lt;- list()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     for (ib in seq_along(yearBreaks)) {</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         d &lt;- sprintf("%4d-01-01", yearBreaks[[ib]])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         floc &lt;- as.formula(sprintf("~ t1 + t1_%4d", yearBreaks[[ib]]))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         res[[d]] &lt;- TVGEV(data = df, response = "TXMax", date = "Date",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         design = breaksX(date = Date, breaks = d, degree = 1),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D         loc = floc)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     }</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## [continuing...] ]find the model with maximum likelihood, and plot</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## something like a profile likelihood for the break date considered</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## as a new parameter. However, the model is not differentiable w.r.t.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ## the break! </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     ll &lt;- sapply(res, logLik)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     plot(yearBreaks, ll, type = "o", pch = 21, col = "orangered",</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D          lwd = 2, bg = "gold", xlab = "break", ylab = "log-lik")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     grid()</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     iMax &lt;- which.max(ll)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     abline(v = yearBreaks[iMax])</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D     abline(h = ll[iMax] - c(0, qchisq(0.95, df = 1) /2),</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D            col = "SpringGreen3", lwd = 2)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ##D </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; ## End(Not run)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> TVGEV&gt; </span>
<span class="r-in"><span><span class="va">pu</span> <span class="op">&lt;-</span> <span class="fu">predictUncond</span><span class="op">(</span><span class="va">res2</span>, newdateFrom <span class="op">=</span> <span class="st">"2020-01-01"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pu</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Date Period Level    Quant        L        U</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2020-01-01      5   95% 37.14826 35.95345 38.34308</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2020-01-01     10   95% 38.22615 36.90582 39.54648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2020-01-01     20   95% 39.30897 37.74285 40.87508</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2020-01-01     30   95% 40.03631 38.22455 41.84808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2020-01-01     40   95% 40.64957 38.58461 42.71454</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2020-01-01     50   95% 41.21583 38.88623 43.54543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 2020-01-01     70   95% 42.29923 39.40572 45.19275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 2020-01-01    100   95% 43.90088 40.10939 47.69237</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

