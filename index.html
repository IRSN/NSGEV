<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Non-Stationary GEV Time Series • NSGEV</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Non-Stationary GEV Time Series">
<meta property="og:description" content="Utility functions for Non-Stationary time series with GEV margins.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">NSGEV</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/IntroTVGEV.html">Time-Varying Models in NSGEV</a>
    </li>
    <li>
      <a href="articles/NSGEV_Val.html">TVGEV: Checks</a>
    </li>
    <li>
      <a href="articles/NSRL.html">TVGEV: Check Return Levels</a>
    </li>
    <li>
      <a href="articles/ProfLik.html">TVGEV: Check Profile Likelihood</a>
    </li>
    <li>
      <a href="articles/simulatedBreaks.html">TVGEV: Check Simulated Trend</a>
    </li>
    <li>
      <a href="articles/Venice.html">TVGEV: Check Venice Example</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/IRSN/NSGEV/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level2">
<h2 id="nsgev">NSGEV<a class="anchor" aria-label="anchor" href="#nsgev"></a>
</h2>
<p>The <strong>NSGEV</strong> R package is devoted to some Non-Stationary Extreme Value models.</p>
<p>The main function of the package is <code>TVGEV</code> which creates an object with class <code>"TVGEV"</code> representing a Time-Varying model with GEV margins depending on the time. This kind of model is especially useful to study <em>block maxima</em>, usually annual maxima. This kind of models could be used with CRAN packages such as <strong>extRemes</strong>, yet <strong>NSGEV</strong> makes it easier to cope with bases of functions. It also brings some new things such as the profile likelihood confidence intervals on the return levels or on the quantile of the maximum on an arbitrary period.</p>
</div>
<div class="section level2">
<h2 id="example">Example<a class="anchor" aria-label="anchor" href="#example"></a>
</h2>
<p>In this example we use the annual maxima of the daily maximal temperature (TX) in Dijon (France) provided as the <code>TXMax_Dijon</code> data frame. Note that the warnings and messages will not be shown in this example.</p>
<p>The annual maxima in Celsius are given in in the column <code>TXMax</code></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/IRSN/NSGEV/" class="external-link">NSGEV</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">TXMax_Dijon</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Year TXMax</span></span>
<span><span class="co">#&gt; 1 1921    NA</span></span>
<span><span class="co">#&gt; 2 1922    NA</span></span>
<span><span class="co">#&gt; 3 1923    NA</span></span>
<span><span class="co">#&gt; 4 1924  33.6</span></span>
<span><span class="co">#&gt; 5 1925  34.2</span></span>
<span><span class="co">#&gt; 6 1926  34.8</span></span></code></pre></div>
<p>A <code>TVGEV</code> model requires a date variable indicating the beginnings of the annual blocks. This variable can be easily created from the <code>Year</code> variable</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">TXMax_Dijon</span>, <span class="va">Date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">Year</span>, <span class="st">"-01-01"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">fit0</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TVGEV.html">TVGEV</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, response <span class="op">=</span> <span class="st">"TXMax"</span>, date <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>              loc <span class="op">=</span> <span class="op">~</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span>
<span><span class="co">#&gt;     mu_0  sigma_0     xi_0 </span></span>
<span><span class="co">#&gt; 32.94616  1.87935 -0.19645</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit0</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-Dijon0-1.png"><!-- --></p>
<p>We can fit a model with a linear time trend. A possibility is to use the <code>polynomX</code> function that creates a basis of polynomial functions for a given degree. This makes a variable <code>t1</code> available for the fit</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/TVGEV.html">TVGEV</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, response <span class="op">=</span> <span class="st">"TXMax"</span>, date <span class="op">=</span> <span class="st">"Date"</span>,</span>
<span>              design <span class="op">=</span> <span class="fu"><a href="reference/polynomX.html">polynomX</a></span><span class="op">(</span>date <span class="op">=</span> <span class="va">Date</span>, degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>              loc <span class="op">=</span> <span class="op">~</span> <span class="va">t1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-Dijon1-1.png"><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="co">#&gt;        mu_0       mu_t1     sigma_0        xi_0 </span></span>
<span><span class="co">#&gt; 32.93752186  0.01527735  1.84567285 -0.20471258</span></span></code></pre></div>
<p>The <code>predict</code> method can be used to compute conditional return levels corresponding to a given year, be it a past or future year. Since a <code>TVGEV</code> object keeps trace of the design function(s) used the prediction does not require a data preparation step. By default the “new” dates at which the return levels are computed are those in the data frame used to fit the model</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pred</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">pred</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-DijonPred-1.png"><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span>, confint <span class="op">=</span> <span class="st">"proflik"</span>, trace <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-DijonPred-2.png"><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit1</span>, newdate <span class="op">=</span> <span class="st">"2040-01-01"</span>, confint <span class="op">=</span> <span class="st">"proflik"</span>, trace <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-DijonPred-3.png"><!-- --></p>
<p>The default confidence intervals are obtained by using the “delta method” but profile likelihood intervals can be obtained as well by using the <code>confintMethod</code> argument (possibly abbreviated as <code>confint</code> of <code>conf</code>). Note that the <code>autoplot</code> method is to be used rather than the <code>plot</code> method, because the **ggplot2* package is used.</p>
<p>Rather than the maximum on a specific block, one can consider the maximum <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> on a larger period as sometimes called a <em>design life period</em>. The distribution of <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>M</mi><annotation encoding="application/x-tex">M</annotation></semantics></math> is then no longer a GEV but the its quantiles can be computed with confidence intervals</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">date</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fl">2025</span><span class="op">:</span><span class="fl">2040</span>, <span class="st">"-01-01"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">qm</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/quantMax.html">quantMax</a></span><span class="op">(</span><span class="va">fit1</span>, date <span class="op">=</span> <span class="va">date</span>, confint <span class="op">=</span> <span class="st">"proflik"</span>, trace <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/autoplot.html" class="external-link">autoplot</a></span><span class="op">(</span><span class="va">qm</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Quantile of the maximum on 2025-2040"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-DijonMax-1.png"><!-- --></p>
<p>By changing the value of the <code>design</code> argument one can different use basis functions such as splines with given knots.</p>
</div>
<div class="section level2">
<h2 id="installation">INSTALLATION<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="section level3">
<h3 id="with-the-remotes-package">With the <em>remotes</em> package<a class="anchor" aria-label="anchor" href="#with-the-remotes-package"></a>
</h3>
<p>In an R session use</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://remotes.r-lib.org" class="external-link">remotes</a></span><span class="op">)</span></span>
<span><span class="fu">install_github</span><span class="op">(</span><span class="st">"IRSN/NSGEV"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>This should install the package and make it ready to use.</p>
<p>Mind that by default this does not build the vignettes shipped with the package (long-form documentation). To build the vignettes, use instead</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">install_github</span><span class="op">(</span><span class="st">"IRSN/NSGEV"</span>, dependencies <span class="op">=</span> <span class="cn">TRUE</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>The installation will then take more time but the vignettes will be accessible from the help of the package (link above the “Help Pages” section).</p>
<p>You can also select a specific branch or a specific commit by using the suitable syntax for <code>install_github</code>. See the <strong>remotes</strong> package documentation for more details.</p>
</div>
<div class="section level3">
<h3 id="precompiled-versions">Precompiled versions<a class="anchor" aria-label="anchor" href="#precompiled-versions"></a>
</h3>
<p>Precompiled versions of the package are available for some platforms and can be downloaded by using the <strong>Releases</strong> link of the GitHub Repository. Use <code>NSGEV_x.y.z.tgz</code> for MacOS, <code>NSGEV_x.y.z.tgz</code> for Windows and <code>NSGEV_x.y.z_R_x86_64-pc-linux-gnu.tar.gz</code> for Linux Ubuntu where <code>x</code>, <code>y</code> and <code>z</code> are the major, minor and patch numbers of the package version.</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/IRSN/NSGEV/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/IRSN/NSGEV/issues/" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing NSGEV</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yves Deville <br><small class="roles"> Maintainer, author </small> <a href="https://orcid.org/0000-0002-1233-488X" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Yves Deville.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
